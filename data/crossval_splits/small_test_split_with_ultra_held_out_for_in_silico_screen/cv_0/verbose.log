Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 584 | train size = 584 | val size = 236 | test size = 236
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0002e+00, PNorm = 52.0836, GNorm = 5.0954, lr_0 = 5.5000e-04
Validation rmse = 1.002217
Epoch 1
Loss = 9.9280e-01, PNorm = 52.1301, GNorm = 2.7092, lr_0 = 1.0000e-03
Validation rmse = 1.079098
Epoch 2
Loss = 8.8471e-01, PNorm = 52.2123, GNorm = 2.4441, lr_0 = 9.5733e-04
Validation rmse = 0.989046
Epoch 3
Loss = 8.1330e-01, PNorm = 52.2848, GNorm = 2.4669, lr_0 = 9.1648e-04
Validation rmse = 0.975459
Epoch 4
Loss = 6.6568e-01, PNorm = 52.3641, GNorm = 2.2293, lr_0 = 8.7355e-04
Validation rmse = 0.938025
Epoch 5
Loss = 8.6375e-01, PNorm = 52.4151, GNorm = 2.8088, lr_0 = 8.3627e-04
Loss = 6.9668e-01, PNorm = 52.4561, GNorm = 2.3899, lr_0 = 8.0059e-04
Validation rmse = 0.912367
Epoch 6
Loss = 7.3813e-01, PNorm = 52.4989, GNorm = 2.5008, lr_0 = 7.6643e-04
Validation rmse = 0.880377
Epoch 7
Loss = 6.2051e-01, PNorm = 52.5366, GNorm = 1.8062, lr_0 = 7.3053e-04
Validation rmse = 0.930917
Epoch 8
Loss = 6.1035e-01, PNorm = 52.5711, GNorm = 2.2179, lr_0 = 6.9935e-04
Validation rmse = 0.891146
Epoch 9
Loss = 6.3234e-01, PNorm = 52.6044, GNorm = 1.7338, lr_0 = 6.6951e-04
Validation rmse = 0.842283
Epoch 10
Loss = 5.9700e-01, PNorm = 52.6430, GNorm = 1.9562, lr_0 = 6.3815e-04
Validation rmse = 0.852130
Epoch 11
Loss = 6.3733e-01, PNorm = 52.6673, GNorm = 1.4887, lr_0 = 6.1092e-04
Loss = 5.8417e-01, PNorm = 52.6958, GNorm = 2.2400, lr_0 = 5.8485e-04
Validation rmse = 0.905955
Epoch 12
Loss = 5.7366e-01, PNorm = 52.7274, GNorm = 2.0535, lr_0 = 5.5989e-04
Validation rmse = 0.927063
Epoch 13
Loss = 5.5720e-01, PNorm = 52.7568, GNorm = 1.4934, lr_0 = 5.3367e-04
Validation rmse = 0.921512
Epoch 14
Loss = 5.2437e-01, PNorm = 52.7816, GNorm = 2.0580, lr_0 = 5.1090e-04
Validation rmse = 0.853987
Epoch 15
Loss = 6.2393e-01, PNorm = 52.8150, GNorm = 2.8210, lr_0 = 4.8910e-04
Validation rmse = 0.844810
Epoch 16
Loss = 5.9746e-01, PNorm = 52.8485, GNorm = 1.0105, lr_0 = 4.6619e-04
Validation rmse = 0.862876
Epoch 17
Loss = 7.2282e-01, PNorm = 52.8727, GNorm = 1.7740, lr_0 = 4.4629e-04
Loss = 5.4970e-01, PNorm = 52.9023, GNorm = 1.7987, lr_0 = 4.2725e-04
Validation rmse = 0.850208
Epoch 18
Loss = 4.7256e-01, PNorm = 52.9318, GNorm = 0.8963, lr_0 = 4.0902e-04
Validation rmse = 0.869010
Epoch 19
Loss = 4.9598e-01, PNorm = 52.9604, GNorm = 1.4723, lr_0 = 3.8986e-04
Validation rmse = 0.843973
Epoch 20
Loss = 4.9609e-01, PNorm = 52.9824, GNorm = 1.0272, lr_0 = 3.7322e-04
Validation rmse = 0.903504
Epoch 21
Loss = 4.4052e-01, PNorm = 53.0058, GNorm = 0.9082, lr_0 = 3.5730e-04
Validation rmse = 0.876044
Epoch 22
Loss = 6.1961e-01, PNorm = 53.0323, GNorm = 1.4782, lr_0 = 3.4056e-04
Validation rmse = 0.837521
Epoch 23
Loss = 4.3035e-01, PNorm = 53.0553, GNorm = 0.6259, lr_0 = 3.2603e-04
Loss = 4.7820e-01, PNorm = 53.0729, GNorm = 1.4457, lr_0 = 3.1212e-04
Validation rmse = 0.843488
Epoch 24
Loss = 4.4555e-01, PNorm = 53.0924, GNorm = 2.0855, lr_0 = 2.9880e-04
Validation rmse = 0.847891
Epoch 25
Loss = 4.8758e-01, PNorm = 53.1117, GNorm = 2.1893, lr_0 = 2.8605e-04
Validation rmse = 0.851275
Epoch 26
Loss = 4.2611e-01, PNorm = 53.1349, GNorm = 2.6425, lr_0 = 2.7265e-04
Validation rmse = 0.856641
Epoch 27
Loss = 4.7942e-01, PNorm = 53.1511, GNorm = 1.3549, lr_0 = 2.6102e-04
Validation rmse = 0.832774
Epoch 28
Loss = 4.2213e-01, PNorm = 53.1683, GNorm = 1.7533, lr_0 = 2.4988e-04
Validation rmse = 0.857763
Epoch 29
Loss = 3.7593e-01, PNorm = 53.1870, GNorm = 1.1849, lr_0 = 2.3817e-04
Loss = 4.6858e-01, PNorm = 53.2014, GNorm = 1.4364, lr_0 = 2.2801e-04
Validation rmse = 0.828261
Epoch 30
Loss = 4.3403e-01, PNorm = 53.2199, GNorm = 2.2183, lr_0 = 2.1828e-04
Validation rmse = 0.830803
Epoch 31
Loss = 4.3131e-01, PNorm = 53.2354, GNorm = 0.8088, lr_0 = 2.0897e-04
Validation rmse = 0.863328
Epoch 32
Loss = 4.3385e-01, PNorm = 53.2501, GNorm = 0.9632, lr_0 = 1.9918e-04
Validation rmse = 0.828731
Epoch 33
Loss = 4.6879e-01, PNorm = 53.2645, GNorm = 1.6933, lr_0 = 1.9068e-04
Validation rmse = 0.857698
Epoch 34
Loss = 3.9870e-01, PNorm = 53.2769, GNorm = 2.5597, lr_0 = 1.8254e-04
Validation rmse = 0.839252
Epoch 35
Loss = 3.7424e-01, PNorm = 53.2918, GNorm = 1.5534, lr_0 = 1.7399e-04
Loss = 4.2915e-01, PNorm = 53.3030, GNorm = 1.7495, lr_0 = 1.6657e-04
Validation rmse = 0.821068
Epoch 36
Loss = 3.7997e-01, PNorm = 53.3163, GNorm = 1.2558, lr_0 = 1.5946e-04
Validation rmse = 0.837734
Epoch 37
Loss = 4.2808e-01, PNorm = 53.3280, GNorm = 1.7477, lr_0 = 1.5266e-04
Validation rmse = 0.818382
Epoch 38
Loss = 4.1933e-01, PNorm = 53.3397, GNorm = 1.4217, lr_0 = 1.4551e-04
Validation rmse = 0.834842
Epoch 39
Loss = 3.6686e-01, PNorm = 53.3492, GNorm = 1.1979, lr_0 = 1.3930e-04
Validation rmse = 0.840281
Epoch 40
Loss = 5.3582e-01, PNorm = 53.3589, GNorm = 1.3837, lr_0 = 1.3335e-04
Validation rmse = 0.842661
Epoch 41
Loss = 4.9454e-01, PNorm = 53.3714, GNorm = 1.3205, lr_0 = 1.2711e-04
Loss = 4.1170e-01, PNorm = 53.3800, GNorm = 1.7010, lr_0 = 1.2168e-04
Validation rmse = 0.846913
Epoch 42
Loss = 4.0915e-01, PNorm = 53.3883, GNorm = 0.9118, lr_0 = 1.1649e-04
Validation rmse = 0.809878
Epoch 43
Loss = 4.7487e-01, PNorm = 53.3980, GNorm = 1.6107, lr_0 = 1.1152e-04
Validation rmse = 0.853668
Epoch 44
Loss = 4.7618e-01, PNorm = 53.4059, GNorm = 1.6152, lr_0 = 1.0630e-04
Validation rmse = 0.840083
Epoch 45
Loss = 3.7860e-01, PNorm = 53.4130, GNorm = 2.3276, lr_0 = 1.0176e-04
Validation rmse = 0.819976
Epoch 46
Loss = 4.1626e-01, PNorm = 53.4185, GNorm = 1.3089, lr_0 = 1.0000e-04
Validation rmse = 0.867949
Epoch 47
Loss = 5.4132e-01, PNorm = 53.4283, GNorm = 1.5044, lr_0 = 1.0000e-04
Loss = 3.6935e-01, PNorm = 53.4334, GNorm = 1.9038, lr_0 = 1.0000e-04
Validation rmse = 0.809715
Epoch 48
Loss = 4.1914e-01, PNorm = 53.4444, GNorm = 1.2943, lr_0 = 1.0000e-04
Validation rmse = 0.835183
Epoch 49
Loss = 4.0455e-01, PNorm = 53.4510, GNorm = 1.4825, lr_0 = 1.0000e-04
Validation rmse = 0.829116
Model 0 best validation rmse = 0.809715 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.809715
Ensemble test rmse = 0.809715
1-fold cross validation
	Seed 42 ==> test rmse = 0.809715
Overall test rmse = 0.809715 +/- 0.000000
Elapsed time = 0:06:50
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 679 | train size = 679 | val size = 141 | test size = 141
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0689e+00, PNorm = 52.0766, GNorm = 2.2765, lr_0 = 4.8077e-04
Validation rmse = 1.013484
Epoch 1
Loss = 8.7957e-01, PNorm = 52.1142, GNorm = 2.4906, lr_0 = 8.6154e-04
Validation rmse = 1.046678
Epoch 2
Loss = 7.3039e-01, PNorm = 52.1878, GNorm = 1.1262, lr_0 = 9.7810e-04
Loss = 8.9821e-01, PNorm = 52.2687, GNorm = 2.1699, lr_0 = 9.4267e-04
Loss = 9.9391e-01, PNorm = 52.2754, GNorm = 2.8766, lr_0 = 9.3920e-04
Validation rmse = 0.894907
Epoch 3
Loss = 8.6614e-01, PNorm = 52.3363, GNorm = 2.3918, lr_0 = 9.0517e-04
Validation rmse = 0.865384
Epoch 4
Loss = 8.7134e-01, PNorm = 52.3830, GNorm = 3.1066, lr_0 = 8.7238e-04
Validation rmse = 0.899607
Epoch 5
Loss = 6.6272e-01, PNorm = 52.4414, GNorm = 0.9168, lr_0 = 8.3768e-04
Loss = 7.5716e-01, PNorm = 52.4914, GNorm = 1.6197, lr_0 = 8.0733e-04
Validation rmse = 0.866060
Epoch 6
Loss = 7.4773e-01, PNorm = 52.5206, GNorm = 1.6468, lr_0 = 7.7808e-04
Validation rmse = 0.830421
Epoch 7
Loss = 7.1807e-01, PNorm = 52.5548, GNorm = 0.9879, lr_0 = 7.4989e-04
Validation rmse = 0.792083
Epoch 8
Loss = 6.5402e-01, PNorm = 52.5975, GNorm = 1.1359, lr_0 = 7.2007e-04
Loss = 6.5705e-01, PNorm = 52.6338, GNorm = 1.3455, lr_0 = 6.9398e-04
Validation rmse = 0.783340
Epoch 9
Loss = 7.1135e-01, PNorm = 52.6653, GNorm = 3.1525, lr_0 = 6.6884e-04
Validation rmse = 0.861338
Epoch 10
Loss = 6.5254e-01, PNorm = 52.7072, GNorm = 2.1524, lr_0 = 6.4223e-04
Validation rmse = 0.825452
Epoch 11
Loss = 5.3239e-01, PNorm = 52.7351, GNorm = 2.5904, lr_0 = 6.1897e-04
Loss = 6.5589e-01, PNorm = 52.7674, GNorm = 1.5602, lr_0 = 5.9654e-04
Validation rmse = 0.744755
Epoch 12
Loss = 6.3894e-01, PNorm = 52.8006, GNorm = 1.3288, lr_0 = 5.7281e-04
Validation rmse = 0.782121
Epoch 13
Loss = 7.5625e-01, PNorm = 52.8380, GNorm = 2.8147, lr_0 = 5.5206e-04
Loss = 6.2984e-01, PNorm = 52.8759, GNorm = 2.8641, lr_0 = 5.3206e-04
Validation rmse = 0.775629
Epoch 14
Loss = 6.8158e-01, PNorm = 52.9092, GNorm = 0.9637, lr_0 = 5.1279e-04
Validation rmse = 0.770280
Epoch 15
Loss = 5.4562e-01, PNorm = 52.9482, GNorm = 1.3121, lr_0 = 4.9239e-04
Validation rmse = 0.818868
Epoch 16
Loss = 5.6412e-01, PNorm = 52.9829, GNorm = 1.5781, lr_0 = 4.7455e-04
Loss = 5.9855e-01, PNorm = 53.0228, GNorm = 2.1254, lr_0 = 4.5736e-04
Loss = 6.8712e-01, PNorm = 53.0259, GNorm = 3.2121, lr_0 = 4.5567e-04
Validation rmse = 0.761283
Epoch 17
Loss = 5.0870e-01, PNorm = 53.0580, GNorm = 1.4533, lr_0 = 4.3917e-04
Validation rmse = 0.762645
Epoch 18
Loss = 4.9703e-01, PNorm = 53.0995, GNorm = 1.9076, lr_0 = 4.2326e-04
Validation rmse = 0.783950
Epoch 19
Loss = 5.8300e-01, PNorm = 53.1361, GNorm = 0.7742, lr_0 = 4.0792e-04
Loss = 5.1646e-01, PNorm = 53.1728, GNorm = 1.7263, lr_0 = 3.9314e-04
Validation rmse = 0.782236
Epoch 20
Loss = 5.4710e-01, PNorm = 53.2094, GNorm = 1.8484, lr_0 = 3.7751e-04
Validation rmse = 0.747457
Epoch 21
Loss = 5.9380e-01, PNorm = 53.2428, GNorm = 1.6180, lr_0 = 3.6383e-04
Validation rmse = 0.802359
Epoch 22
Loss = 4.3986e-01, PNorm = 53.2799, GNorm = 2.3384, lr_0 = 3.4936e-04
Loss = 5.3830e-01, PNorm = 53.3116, GNorm = 2.4730, lr_0 = 3.3670e-04
Validation rmse = 0.815987
Epoch 23
Loss = 4.5698e-01, PNorm = 53.3463, GNorm = 4.1869, lr_0 = 3.2450e-04
Validation rmse = 0.771045
Epoch 24
Loss = 5.0925e-01, PNorm = 53.3793, GNorm = 1.3250, lr_0 = 3.1159e-04
Validation rmse = 0.806502
Epoch 25
Loss = 6.0097e-01, PNorm = 53.4043, GNorm = 2.2662, lr_0 = 3.0031e-04
Loss = 4.9799e-01, PNorm = 53.4287, GNorm = 3.6818, lr_0 = 2.8943e-04
Validation rmse = 0.801768
Epoch 26
Loss = 4.4395e-01, PNorm = 53.4552, GNorm = 1.2334, lr_0 = 2.7894e-04
Validation rmse = 0.803146
Epoch 27
Loss = 3.9528e-01, PNorm = 53.4798, GNorm = 1.1780, lr_0 = 2.6785e-04
Loss = 4.6051e-01, PNorm = 53.5041, GNorm = 2.8492, lr_0 = 2.5814e-04
Validation rmse = 0.788725
Epoch 28
Loss = 4.0030e-01, PNorm = 53.5229, GNorm = 0.8920, lr_0 = 2.4879e-04
Validation rmse = 0.783740
Epoch 29
Loss = 3.4121e-01, PNorm = 53.5428, GNorm = 2.1025, lr_0 = 2.3889e-04
Validation rmse = 0.801818
Epoch 30
Loss = 2.7320e-01, PNorm = 53.5593, GNorm = 0.9821, lr_0 = 2.3024e-04
Loss = 4.4257e-01, PNorm = 53.5765, GNorm = 1.7424, lr_0 = 2.2190e-04
Loss = 4.4579e-01, PNorm = 53.5786, GNorm = 2.0309, lr_0 = 2.2108e-04
Validation rmse = 0.784197
Epoch 31
Loss = 4.1535e-01, PNorm = 53.5933, GNorm = 1.4781, lr_0 = 2.1307e-04
Validation rmse = 0.797433
Epoch 32
Loss = 3.5082e-01, PNorm = 53.6106, GNorm = 2.9420, lr_0 = 2.0535e-04
Validation rmse = 0.824953
Epoch 33
Loss = 5.7791e-01, PNorm = 53.6275, GNorm = 1.6797, lr_0 = 1.9791e-04
Loss = 3.4048e-01, PNorm = 53.6418, GNorm = 2.1035, lr_0 = 1.9074e-04
Validation rmse = 0.817356
Epoch 34
Loss = 4.2868e-01, PNorm = 53.6568, GNorm = 1.4460, lr_0 = 1.8316e-04
Validation rmse = 0.804885
Epoch 35
Loss = 3.5770e-01, PNorm = 53.6704, GNorm = 1.9988, lr_0 = 1.7652e-04
Validation rmse = 0.815203
Epoch 36
Loss = 3.5808e-01, PNorm = 53.6833, GNorm = 1.7200, lr_0 = 1.6950e-04
Loss = 4.1847e-01, PNorm = 53.6940, GNorm = 1.4224, lr_0 = 1.6336e-04
Validation rmse = 0.822431
Epoch 37
Loss = 3.7877e-01, PNorm = 53.7038, GNorm = 2.4172, lr_0 = 1.5744e-04
Validation rmse = 0.804458
Epoch 38
Loss = 4.1736e-01, PNorm = 53.7155, GNorm = 1.3314, lr_0 = 1.5174e-04
Validation rmse = 0.805618
Epoch 39
Loss = 2.7641e-01, PNorm = 53.7269, GNorm = 1.0701, lr_0 = 1.4570e-04
Loss = 3.6275e-01, PNorm = 53.7379, GNorm = 2.0868, lr_0 = 1.4042e-04
Validation rmse = 0.806278
Epoch 40
Loss = 3.5186e-01, PNorm = 53.7487, GNorm = 0.9154, lr_0 = 1.3534e-04
Validation rmse = 0.794791
Epoch 41
Loss = 3.2115e-01, PNorm = 53.7568, GNorm = 1.6883, lr_0 = 1.2995e-04
Loss = 3.9285e-01, PNorm = 53.7644, GNorm = 2.1102, lr_0 = 1.2524e-04
Validation rmse = 0.806144
Epoch 42
Loss = 3.0767e-01, PNorm = 53.7725, GNorm = 1.4349, lr_0 = 1.2071e-04
Validation rmse = 0.807755
Epoch 43
Loss = 3.6553e-01, PNorm = 53.7806, GNorm = 4.4642, lr_0 = 1.1591e-04
Validation rmse = 0.803335
Epoch 44
Loss = 4.1620e-01, PNorm = 53.7891, GNorm = 3.7800, lr_0 = 1.1171e-04
Loss = 3.7635e-01, PNorm = 53.7947, GNorm = 1.6272, lr_0 = 1.0766e-04
Validation rmse = 0.815449
Epoch 45
Loss = 3.3892e-01, PNorm = 53.8043, GNorm = 1.1731, lr_0 = 1.0376e-04
Validation rmse = 0.813995
Epoch 46
Loss = 4.0781e-01, PNorm = 53.8108, GNorm = 0.9179, lr_0 = 1.0000e-04
Validation rmse = 0.818844
Epoch 47
Loss = 3.6450e-01, PNorm = 53.8191, GNorm = 2.4006, lr_0 = 1.0000e-04
Loss = 3.6014e-01, PNorm = 53.8251, GNorm = 1.1065, lr_0 = 1.0000e-04
Validation rmse = 0.797137
Epoch 48
Loss = 3.4971e-01, PNorm = 53.8325, GNorm = 1.1674, lr_0 = 1.0000e-04
Validation rmse = 0.803357
Epoch 49
Loss = 3.9465e-01, PNorm = 53.8379, GNorm = 1.4062, lr_0 = 1.0000e-04
Validation rmse = 0.837026
Model 0 best validation rmse = 0.744755 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.744755
Ensemble test rmse = 0.744755
1-fold cross validation
	Seed 42 ==> test rmse = 0.744755
Overall test rmse = 0.744755 +/- 0.000000
Elapsed time = 0:07:02
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 635 | train size = 635 | val size = 185 | test size = 185
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.1414e+00, PNorm = 52.0780, GNorm = 6.3003, lr_0 = 5.1250e-04
Validation rmse = 1.072673
Epoch 1
Loss = 1.1399e+00, PNorm = 52.1218, GNorm = 1.2137, lr_0 = 9.2500e-04
Validation rmse = 0.882781
Epoch 2
Loss = 1.0824e+00, PNorm = 52.2020, GNorm = 1.2796, lr_0 = 9.6853e-04
Validation rmse = 0.950654
Epoch 3
Loss = 1.0020e+00, PNorm = 52.2915, GNorm = 1.0714, lr_0 = 9.3057e-04
Loss = 7.4752e-01, PNorm = 52.3535, GNorm = 3.7256, lr_0 = 8.9411e-04
Loss = 8.5238e-01, PNorm = 52.3594, GNorm = 1.9699, lr_0 = 8.9054e-04
Validation rmse = 1.092379
Epoch 4
Loss = 7.7076e-01, PNorm = 52.4021, GNorm = 2.5669, lr_0 = 8.5564e-04
Validation rmse = 0.955130
Epoch 5
Loss = 6.1217e-01, PNorm = 52.4420, GNorm = 2.5134, lr_0 = 8.2211e-04
Validation rmse = 0.857834
Epoch 6
Loss = 5.4362e-01, PNorm = 52.4836, GNorm = 1.7896, lr_0 = 7.8990e-04
Validation rmse = 0.935749
Epoch 7
Loss = 6.4825e-01, PNorm = 52.5263, GNorm = 3.4988, lr_0 = 7.5591e-04
Loss = 6.7008e-01, PNorm = 52.5625, GNorm = 1.9627, lr_0 = 7.2629e-04
Validation rmse = 0.897371
Epoch 8
Loss = 6.9941e-01, PNorm = 52.5997, GNorm = 3.2786, lr_0 = 6.9783e-04
Validation rmse = 0.985389
Epoch 9
Loss = 6.8943e-01, PNorm = 52.6371, GNorm = 2.9700, lr_0 = 6.7048e-04
Validation rmse = 0.962769
Epoch 10
Loss = 5.0603e-01, PNorm = 52.6759, GNorm = 1.9548, lr_0 = 6.4421e-04
Validation rmse = 0.975078
Epoch 11
Loss = 6.8653e-01, PNorm = 52.7114, GNorm = 2.0149, lr_0 = 6.1650e-04
Loss = 5.5059e-01, PNorm = 52.7398, GNorm = 1.1331, lr_0 = 5.9234e-04
Validation rmse = 0.919090
Epoch 12
Loss = 5.0627e-01, PNorm = 52.7731, GNorm = 2.3083, lr_0 = 5.6913e-04
Validation rmse = 0.876593
Epoch 13
Loss = 4.4143e-01, PNorm = 52.7982, GNorm = 1.1255, lr_0 = 5.4682e-04
Validation rmse = 0.955669
Epoch 14
Loss = 4.7890e-01, PNorm = 52.8289, GNorm = 2.2047, lr_0 = 5.2330e-04
Loss = 5.5096e-01, PNorm = 52.8498, GNorm = 2.1188, lr_0 = 5.0279e-04
Validation rmse = 0.932735
Epoch 15
Loss = 6.0288e-01, PNorm = 52.8692, GNorm = 1.4778, lr_0 = 4.8309e-04
Validation rmse = 0.954971
Epoch 16
Loss = 4.7866e-01, PNorm = 52.8964, GNorm = 1.0908, lr_0 = 4.6416e-04
Validation rmse = 0.941208
Epoch 17
Loss = 4.2771e-01, PNorm = 52.9170, GNorm = 2.0261, lr_0 = 4.4419e-04
Validation rmse = 0.921291
Epoch 18
Loss = 5.3581e-01, PNorm = 52.9439, GNorm = 0.9853, lr_0 = 4.2678e-04
Loss = 5.2153e-01, PNorm = 52.9677, GNorm = 1.7489, lr_0 = 4.1006e-04
Validation rmse = 0.961479
Epoch 19
Loss = 4.8857e-01, PNorm = 52.9843, GNorm = 0.9174, lr_0 = 3.9399e-04
Validation rmse = 0.931115
Epoch 20
Loss = 3.8498e-01, PNorm = 53.0040, GNorm = 1.1388, lr_0 = 3.7855e-04
Validation rmse = 0.917393
Epoch 21
Loss = 3.2136e-01, PNorm = 53.0240, GNorm = 0.9019, lr_0 = 3.6227e-04
Validation rmse = 0.922058
Epoch 22
Loss = 2.8533e-01, PNorm = 53.0414, GNorm = 1.0271, lr_0 = 3.4807e-04
Loss = 4.8816e-01, PNorm = 53.0584, GNorm = 1.3692, lr_0 = 3.3443e-04
Validation rmse = 0.919883
Epoch 23
Loss = 5.3625e-01, PNorm = 53.0803, GNorm = 1.6767, lr_0 = 3.2132e-04
Validation rmse = 0.931082
Epoch 24
Loss = 4.3703e-01, PNorm = 53.0967, GNorm = 1.6253, lr_0 = 3.0750e-04
Validation rmse = 0.936028
Epoch 25
Loss = 5.7031e-01, PNorm = 53.1155, GNorm = 1.1140, lr_0 = 2.9545e-04
Loss = 4.4698e-01, PNorm = 53.1341, GNorm = 1.4220, lr_0 = 2.8387e-04
Validation rmse = 0.872022
Epoch 26
Loss = 4.6493e-01, PNorm = 53.1511, GNorm = 1.4917, lr_0 = 2.7275e-04
Validation rmse = 0.871087
Epoch 27
Loss = 4.1509e-01, PNorm = 53.1677, GNorm = 1.3200, lr_0 = 2.6102e-04
Validation rmse = 0.893816
Epoch 28
Loss = 4.3955e-01, PNorm = 53.1835, GNorm = 0.9327, lr_0 = 2.5079e-04
Validation rmse = 0.900495
Epoch 29
Loss = 3.2483e-01, PNorm = 53.1982, GNorm = 1.5485, lr_0 = 2.4096e-04
Loss = 4.9170e-01, PNorm = 53.2155, GNorm = 1.2991, lr_0 = 2.3152e-04
Validation rmse = 0.851229
Epoch 30
Loss = 4.4858e-01, PNorm = 53.2292, GNorm = 0.9631, lr_0 = 2.2244e-04
Validation rmse = 0.881257
Epoch 31
Loss = 3.6595e-01, PNorm = 53.2470, GNorm = 0.9592, lr_0 = 2.1288e-04
Validation rmse = 0.879504
Epoch 32
Loss = 5.9848e-01, PNorm = 53.2591, GNorm = 1.5590, lr_0 = 2.0453e-04
Validation rmse = 0.873444
Epoch 33
Loss = 3.3822e-01, PNorm = 53.2707, GNorm = 1.0168, lr_0 = 1.9652e-04
Loss = 4.4826e-01, PNorm = 53.2839, GNorm = 1.5723, lr_0 = 1.8882e-04
Validation rmse = 0.854173
Epoch 34
Loss = 4.0056e-01, PNorm = 53.2953, GNorm = 1.1576, lr_0 = 1.8069e-04
Validation rmse = 0.859006
Epoch 35
Loss = 4.4763e-01, PNorm = 53.3071, GNorm = 1.2099, lr_0 = 1.7361e-04
Validation rmse = 0.826833
Epoch 36
Loss = 3.5727e-01, PNorm = 53.3189, GNorm = 1.0219, lr_0 = 1.6681e-04
Validation rmse = 0.818373
Epoch 37
Loss = 1.5467e-01, PNorm = 53.3316, GNorm = 0.6642, lr_0 = 1.5963e-04
Loss = 4.9262e-01, PNorm = 53.3441, GNorm = 2.4788, lr_0 = 1.5338e-04
Validation rmse = 0.806179
Epoch 38
Loss = 4.4132e-01, PNorm = 53.3530, GNorm = 1.6057, lr_0 = 1.4737e-04
Validation rmse = 0.826268
Epoch 39
Loss = 3.4910e-01, PNorm = 53.3655, GNorm = 3.3321, lr_0 = 1.4159e-04
Validation rmse = 0.860394
Epoch 40
Loss = 3.8744e-01, PNorm = 53.3764, GNorm = 2.1800, lr_0 = 1.3604e-04
Loss = 4.4845e-01, PNorm = 53.3868, GNorm = 1.3286, lr_0 = 1.3071e-04
Loss = 2.7814e-01, PNorm = 53.3875, GNorm = 1.4403, lr_0 = 1.3019e-04
Validation rmse = 0.801517
Epoch 41
Loss = 3.5122e-01, PNorm = 53.3964, GNorm = 1.6117, lr_0 = 1.2509e-04
Validation rmse = 0.844295
Epoch 42
Loss = 4.3121e-01, PNorm = 53.4059, GNorm = 1.8148, lr_0 = 1.2019e-04
Validation rmse = 0.815339
Epoch 43
Loss = 3.9292e-01, PNorm = 53.4128, GNorm = 0.8831, lr_0 = 1.1548e-04
Validation rmse = 0.819019
Epoch 44
Loss = 3.4235e-01, PNorm = 53.4215, GNorm = 0.9950, lr_0 = 1.1051e-04
Loss = 3.9467e-01, PNorm = 53.4303, GNorm = 1.1235, lr_0 = 1.0618e-04
Validation rmse = 0.777941
Epoch 45
Loss = 3.4962e-01, PNorm = 53.4359, GNorm = 1.3637, lr_0 = 1.0202e-04
Validation rmse = 0.821835
Epoch 46
Loss = 3.9463e-01, PNorm = 53.4435, GNorm = 0.9257, lr_0 = 1.0000e-04
Validation rmse = 0.804818
Epoch 47
Loss = 4.0267e-01, PNorm = 53.4509, GNorm = 3.4291, lr_0 = 1.0000e-04
Validation rmse = 0.767744
Epoch 48
Loss = 9.0619e-01, PNorm = 53.4584, GNorm = 2.3954, lr_0 = 1.0000e-04
Loss = 3.9192e-01, PNorm = 53.4646, GNorm = 2.2336, lr_0 = 1.0000e-04
Validation rmse = 0.782902
Epoch 49
Loss = 4.2670e-01, PNorm = 53.4719, GNorm = 1.8277, lr_0 = 1.0000e-04
Validation rmse = 0.800408
Model 0 best validation rmse = 0.767744 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.767744
Ensemble test rmse = 0.767744
1-fold cross validation
	Seed 42 ==> test rmse = 0.767744
Overall test rmse = 0.767744 +/- 0.000000
Elapsed time = 0:07:07
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 686 | train size = 686 | val size = 134 | test size = 134
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.1327e+00, PNorm = 52.0798, GNorm = 2.7713, lr_0 = 4.8077e-04
Validation rmse = 1.198835
Epoch 1
Loss = 1.0816e+00, PNorm = 52.1128, GNorm = 3.9037, lr_0 = 8.6154e-04
Validation rmse = 1.198895
Epoch 2
Loss = 1.2703e+00, PNorm = 52.1895, GNorm = 2.1269, lr_0 = 9.7810e-04
Loss = 1.0300e+00, PNorm = 52.2843, GNorm = 3.9765, lr_0 = 9.4267e-04
Validation rmse = 1.106391
Epoch 3
Loss = 9.2108e-01, PNorm = 52.3684, GNorm = 1.0386, lr_0 = 9.0852e-04
Validation rmse = 1.171448
Epoch 4
Loss = 8.3331e-01, PNorm = 52.4352, GNorm = 1.9252, lr_0 = 8.7238e-04
Validation rmse = 1.095056
Epoch 5
Loss = 6.5221e-01, PNorm = 52.4790, GNorm = 0.9510, lr_0 = 8.4077e-04
Loss = 8.0871e-01, PNorm = 52.5244, GNorm = 1.0482, lr_0 = 8.1031e-04
Validation rmse = 1.139461
Epoch 6
Loss = 7.1376e-01, PNorm = 52.5692, GNorm = 2.7634, lr_0 = 7.8096e-04
Validation rmse = 1.100186
Epoch 7
Loss = 8.6449e-01, PNorm = 52.6121, GNorm = 3.2016, lr_0 = 7.5267e-04
Validation rmse = 1.155374
Epoch 8
Loss = 6.5947e-01, PNorm = 52.6693, GNorm = 1.7802, lr_0 = 7.2273e-04
Loss = 6.5598e-01, PNorm = 52.7080, GNorm = 0.9933, lr_0 = 6.9654e-04
Validation rmse = 1.165033
Epoch 9
Loss = 6.9754e-01, PNorm = 52.7483, GNorm = 2.3767, lr_0 = 6.7131e-04
Validation rmse = 1.192500
Epoch 10
Loss = 7.2722e-01, PNorm = 52.7854, GNorm = 1.3001, lr_0 = 6.4699e-04
Loss = 6.5617e-01, PNorm = 52.8142, GNorm = 0.9825, lr_0 = 6.2355e-04
Loss = 5.8777e-01, PNorm = 52.8168, GNorm = 0.9924, lr_0 = 6.2125e-04
Validation rmse = 1.104767
Epoch 11
Loss = 6.6470e-01, PNorm = 52.8569, GNorm = 1.0559, lr_0 = 5.9875e-04
Validation rmse = 1.134856
Epoch 12
Loss = 5.4322e-01, PNorm = 52.8879, GNorm = 1.1060, lr_0 = 5.7706e-04
Validation rmse = 1.125347
Epoch 13
Loss = 5.3260e-01, PNorm = 52.9209, GNorm = 1.0393, lr_0 = 5.5615e-04
Loss = 6.0589e-01, PNorm = 52.9574, GNorm = 1.4441, lr_0 = 5.3600e-04
Validation rmse = 1.105668
Epoch 14
Loss = 5.8244e-01, PNorm = 52.9923, GNorm = 1.9169, lr_0 = 5.1658e-04
Validation rmse = 1.133437
Epoch 15
Loss = 4.9926e-01, PNorm = 53.0291, GNorm = 1.4126, lr_0 = 4.9604e-04
Validation rmse = 1.093590
Epoch 16
Loss = 3.9846e-01, PNorm = 53.0641, GNorm = 1.0768, lr_0 = 4.7807e-04
Loss = 5.4323e-01, PNorm = 53.1000, GNorm = 1.1673, lr_0 = 4.6075e-04
Validation rmse = 1.089316
Epoch 17
Loss = 5.4007e-01, PNorm = 53.1325, GNorm = 1.8906, lr_0 = 4.4405e-04
Validation rmse = 1.115302
Epoch 18
Loss = 4.2784e-01, PNorm = 53.1654, GNorm = 2.0831, lr_0 = 4.2639e-04
Loss = 5.0965e-01, PNorm = 53.1925, GNorm = 1.4513, lr_0 = 4.1094e-04
Validation rmse = 1.072168
Epoch 19
Loss = 4.9643e-01, PNorm = 53.2206, GNorm = 1.4284, lr_0 = 3.9606e-04
Validation rmse = 1.097249
Epoch 20
Loss = 4.9015e-01, PNorm = 53.2513, GNorm = 1.2338, lr_0 = 3.8171e-04
Validation rmse = 1.143841
Epoch 21
Loss = 5.8059e-01, PNorm = 53.2752, GNorm = 1.4356, lr_0 = 3.6788e-04
Loss = 4.3189e-01, PNorm = 53.3017, GNorm = 1.9415, lr_0 = 3.5455e-04
Validation rmse = 1.105815
Epoch 22
Loss = 4.9829e-01, PNorm = 53.3273, GNorm = 1.3758, lr_0 = 3.4045e-04
Validation rmse = 1.129699
Epoch 23
Loss = 5.6632e-01, PNorm = 53.3530, GNorm = 5.8704, lr_0 = 3.2811e-04
Validation rmse = 1.088880
Epoch 24
Loss = 3.3669e-01, PNorm = 53.3805, GNorm = 1.2031, lr_0 = 3.1623e-04
Loss = 4.4088e-01, PNorm = 53.4046, GNorm = 2.1820, lr_0 = 3.0477e-04
Validation rmse = 1.113745
Epoch 25
Loss = 4.7303e-01, PNorm = 53.4228, GNorm = 1.3728, lr_0 = 2.9373e-04
Validation rmse = 1.082961
Epoch 26
Loss = 5.5250e-01, PNorm = 53.4429, GNorm = 2.2396, lr_0 = 2.8205e-04
Loss = 4.0419e-01, PNorm = 53.4592, GNorm = 1.1700, lr_0 = 2.7183e-04
Validation rmse = 1.080499
Epoch 27
Loss = 4.2850e-01, PNorm = 53.4771, GNorm = 1.0677, lr_0 = 2.6198e-04
Validation rmse = 1.094940
Epoch 28
Loss = 3.6565e-01, PNorm = 53.4949, GNorm = 1.7486, lr_0 = 2.5249e-04
Validation rmse = 1.087874
Epoch 29
Loss = 4.7383e-01, PNorm = 53.5111, GNorm = 0.9247, lr_0 = 2.4245e-04
Loss = 4.2162e-01, PNorm = 53.5244, GNorm = 2.9408, lr_0 = 2.3366e-04
Validation rmse = 1.100584
Epoch 30
Loss = 4.2569e-01, PNorm = 53.5397, GNorm = 1.8499, lr_0 = 2.2520e-04
Validation rmse = 1.085264
Epoch 31
Loss = 4.2267e-01, PNorm = 53.5537, GNorm = 2.9780, lr_0 = 2.1704e-04
Validation rmse = 1.091153
Epoch 32
Loss = 4.1173e-01, PNorm = 53.5681, GNorm = 1.5821, lr_0 = 2.0918e-04
Loss = 4.6304e-01, PNorm = 53.5833, GNorm = 1.9337, lr_0 = 2.0160e-04
Validation rmse = 1.093966
Epoch 33
Loss = 3.8825e-01, PNorm = 53.5973, GNorm = 1.8767, lr_0 = 1.9358e-04
Validation rmse = 1.089042
Epoch 34
Loss = 4.4282e-01, PNorm = 53.6118, GNorm = 1.3405, lr_0 = 1.8657e-04
Loss = 4.0363e-01, PNorm = 53.6237, GNorm = 1.1125, lr_0 = 1.7981e-04
Validation rmse = 1.089640
Epoch 35
Loss = 3.8352e-01, PNorm = 53.6334, GNorm = 1.7590, lr_0 = 1.7329e-04
Validation rmse = 1.108629
Epoch 36
Loss = 4.2141e-01, PNorm = 53.6457, GNorm = 1.8956, lr_0 = 1.6640e-04
Validation rmse = 1.074461
Epoch 37
Loss = 3.4777e-01, PNorm = 53.6569, GNorm = 1.6742, lr_0 = 1.6037e-04
Loss = 4.0383e-01, PNorm = 53.6660, GNorm = 1.8558, lr_0 = 1.5456e-04
Validation rmse = 1.107640
Epoch 38
Loss = 3.8332e-01, PNorm = 53.6752, GNorm = 2.0867, lr_0 = 1.4896e-04
Validation rmse = 1.082435
Epoch 39
Loss = 3.5448e-01, PNorm = 53.6838, GNorm = 0.9770, lr_0 = 1.4357e-04
Validation rmse = 1.094339
Epoch 40
Loss = 3.0628e-01, PNorm = 53.6910, GNorm = 1.5204, lr_0 = 1.3786e-04
Loss = 4.2601e-01, PNorm = 53.7005, GNorm = 2.3977, lr_0 = 1.3286e-04
Validation rmse = 1.097552
Epoch 41
Loss = 4.0511e-01, PNorm = 53.7076, GNorm = 2.4133, lr_0 = 1.2805e-04
Validation rmse = 1.091472
Epoch 42
Loss = 4.5782e-01, PNorm = 53.7161, GNorm = 1.5484, lr_0 = 1.2341e-04
Validation rmse = 1.094543
Epoch 43
Loss = 3.0620e-01, PNorm = 53.7228, GNorm = 1.1720, lr_0 = 1.1850e-04
Loss = 4.0912e-01, PNorm = 53.7298, GNorm = 1.9156, lr_0 = 1.1421e-04
Validation rmse = 1.088233
Epoch 44
Loss = 4.0553e-01, PNorm = 53.7370, GNorm = 1.6167, lr_0 = 1.1007e-04
Validation rmse = 1.094518
Epoch 45
Loss = 3.4749e-01, PNorm = 53.7430, GNorm = 2.3196, lr_0 = 1.0608e-04
Loss = 3.7816e-01, PNorm = 53.7485, GNorm = 1.6064, lr_0 = 1.0224e-04
Validation rmse = 1.098043
Epoch 46
Loss = 3.9525e-01, PNorm = 53.7537, GNorm = 1.3473, lr_0 = 1.0000e-04
Validation rmse = 1.100104
Epoch 47
Loss = 3.5565e-01, PNorm = 53.7592, GNorm = 2.3744, lr_0 = 1.0000e-04
Validation rmse = 1.100843
Epoch 48
Loss = 4.5493e-01, PNorm = 53.7653, GNorm = 2.9586, lr_0 = 1.0000e-04
Loss = 3.7064e-01, PNorm = 53.7705, GNorm = 1.2563, lr_0 = 1.0000e-04
Validation rmse = 1.087292
Epoch 49
Loss = 3.6676e-01, PNorm = 53.7755, GNorm = 1.8115, lr_0 = 1.0000e-04
Validation rmse = 1.116932
Model 0 best validation rmse = 1.072168 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 1.072168
Ensemble test rmse = 1.072168
1-fold cross validation
	Seed 42 ==> test rmse = 1.072168
Overall test rmse = 1.072168 +/- 0.000000
Elapsed time = 0:07:12
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 696 | train size = 696 | val size = 124 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0602e+00, PNorm = 52.0793, GNorm = 2.9841, lr_0 = 4.8077e-04
Validation rmse = 1.081243
Epoch 1
Loss = 1.0775e+00, PNorm = 52.1110, GNorm = 3.2462, lr_0 = 8.6154e-04
Validation rmse = 1.108900
Epoch 2
Loss = 9.6769e-01, PNorm = 52.1822, GNorm = 1.5918, lr_0 = 9.7810e-04
Loss = 9.2016e-01, PNorm = 52.2666, GNorm = 1.3441, lr_0 = 9.4267e-04
Validation rmse = 1.073749
Epoch 3
Loss = 7.9701e-01, PNorm = 52.3386, GNorm = 1.6343, lr_0 = 9.0852e-04
Validation rmse = 0.938410
Epoch 4
Loss = 7.1624e-01, PNorm = 52.3875, GNorm = 7.3531, lr_0 = 8.7560e-04
Validation rmse = 1.011160
Epoch 5
Loss = 8.5578e-01, PNorm = 52.4293, GNorm = 1.6894, lr_0 = 8.4388e-04
Loss = 7.0149e-01, PNorm = 52.4673, GNorm = 3.3803, lr_0 = 8.1331e-04
Validation rmse = 0.994624
Epoch 6
Loss = 8.5870e-01, PNorm = 52.4987, GNorm = 1.7070, lr_0 = 7.8385e-04
Validation rmse = 0.986810
Epoch 7
Loss = 7.6906e-01, PNorm = 52.5300, GNorm = 1.9275, lr_0 = 7.5545e-04
Loss = 6.5989e-01, PNorm = 52.5656, GNorm = 0.9876, lr_0 = 7.2808e-04
Validation rmse = 0.900763
Epoch 8
Loss = 6.4479e-01, PNorm = 52.5942, GNorm = 1.2337, lr_0 = 7.0170e-04
Validation rmse = 0.995063
Epoch 9
Loss = 5.6986e-01, PNorm = 52.6267, GNorm = 0.9977, lr_0 = 6.7628e-04
Validation rmse = 0.987606
Epoch 10
Loss = 8.1802e-01, PNorm = 52.6631, GNorm = 2.3284, lr_0 = 6.5178e-04
Loss = 6.6294e-01, PNorm = 52.7038, GNorm = 1.5177, lr_0 = 6.2817e-04
Validation rmse = 0.875789
Epoch 11
Loss = 6.6110e-01, PNorm = 52.7465, GNorm = 4.4230, lr_0 = 6.0541e-04
Validation rmse = 1.008923
Epoch 12
Loss = 5.0259e-01, PNorm = 52.7839, GNorm = 0.9961, lr_0 = 5.8348e-04
Loss = 6.4630e-01, PNorm = 52.8280, GNorm = 1.5168, lr_0 = 5.6234e-04
Loss = 7.6341e-01, PNorm = 52.8318, GNorm = 2.0001, lr_0 = 5.6027e-04
Validation rmse = 0.979246
Epoch 13
Loss = 5.9444e-01, PNorm = 52.8720, GNorm = 1.9819, lr_0 = 5.3997e-04
Validation rmse = 0.874535
Epoch 14
Loss = 5.2015e-01, PNorm = 52.9152, GNorm = 2.1220, lr_0 = 5.2041e-04
Validation rmse = 0.875502
Epoch 15
Loss = 5.8946e-01, PNorm = 52.9529, GNorm = 1.1566, lr_0 = 5.0156e-04
Loss = 5.5194e-01, PNorm = 52.9985, GNorm = 1.9777, lr_0 = 4.8339e-04
Validation rmse = 0.950229
Epoch 16
Loss = 5.4489e-01, PNorm = 53.0370, GNorm = 3.2935, lr_0 = 4.6587e-04
Validation rmse = 1.083046
Epoch 17
Loss = 6.7023e-01, PNorm = 53.0762, GNorm = 1.4904, lr_0 = 4.4900e-04
Loss = 4.7087e-01, PNorm = 53.1083, GNorm = 1.7740, lr_0 = 4.3273e-04
Validation rmse = 1.039994
Epoch 18
Loss = 5.2921e-01, PNorm = 53.1392, GNorm = 1.3423, lr_0 = 4.1705e-04
Validation rmse = 0.991966
Epoch 19
Loss = 4.5240e-01, PNorm = 53.1720, GNorm = 1.9040, lr_0 = 4.0195e-04
Validation rmse = 0.978710
Epoch 20
Loss = 3.7606e-01, PNorm = 53.1975, GNorm = 1.0665, lr_0 = 3.8738e-04
Loss = 5.4696e-01, PNorm = 53.2256, GNorm = 1.6567, lr_0 = 3.7335e-04
Validation rmse = 0.948258
Epoch 21
Loss = 5.1363e-01, PNorm = 53.2557, GNorm = 1.1522, lr_0 = 3.5982e-04
Validation rmse = 1.012938
Epoch 22
Loss = 4.9095e-01, PNorm = 53.2841, GNorm = 2.0954, lr_0 = 3.4679e-04
Loss = 4.9591e-01, PNorm = 53.3061, GNorm = 1.0769, lr_0 = 3.3422e-04
Validation rmse = 0.950692
Epoch 23
Loss = 4.9477e-01, PNorm = 53.3308, GNorm = 2.2941, lr_0 = 3.2212e-04
Validation rmse = 0.923630
Epoch 24
Loss = 5.2815e-01, PNorm = 53.3527, GNorm = 2.0453, lr_0 = 3.1045e-04
Validation rmse = 0.878610
Epoch 25
Loss = 6.1545e-01, PNorm = 53.3814, GNorm = 2.7100, lr_0 = 2.9920e-04
Loss = 4.1569e-01, PNorm = 53.4045, GNorm = 1.0366, lr_0 = 2.8836e-04
Validation rmse = 0.954930
Epoch 26
Loss = 4.6478e-01, PNorm = 53.4309, GNorm = 1.5339, lr_0 = 2.7689e-04
Validation rmse = 0.929782
Epoch 27
Loss = 3.7516e-01, PNorm = 53.4511, GNorm = 2.0233, lr_0 = 2.6686e-04
Validation rmse = 0.913957
Epoch 28
Loss = 2.6022e-01, PNorm = 53.4696, GNorm = 2.0268, lr_0 = 2.5719e-04
Loss = 4.8731e-01, PNorm = 53.4908, GNorm = 1.5207, lr_0 = 2.4787e-04
Validation rmse = 0.950487
Epoch 29
Loss = 4.9672e-01, PNorm = 53.5088, GNorm = 1.7087, lr_0 = 2.3889e-04
Validation rmse = 0.939953
Epoch 30
Loss = 3.5549e-01, PNorm = 53.5241, GNorm = 1.1666, lr_0 = 2.3024e-04
Loss = 4.7413e-01, PNorm = 53.5411, GNorm = 1.2311, lr_0 = 2.2190e-04
Validation rmse = 0.987576
Epoch 31
Loss = 4.4189e-01, PNorm = 53.5572, GNorm = 1.2155, lr_0 = 2.1386e-04
Validation rmse = 1.017878
Epoch 32
Loss = 4.3194e-01, PNorm = 53.5714, GNorm = 1.0951, lr_0 = 2.0611e-04
Validation rmse = 1.002410
Epoch 33
Loss = 4.0897e-01, PNorm = 53.5845, GNorm = 1.4054, lr_0 = 1.9864e-04
Loss = 4.6407e-01, PNorm = 53.6050, GNorm = 1.3736, lr_0 = 1.9145e-04
Validation rmse = 0.905597
Epoch 34
Loss = 4.2888e-01, PNorm = 53.6193, GNorm = 2.5880, lr_0 = 1.8451e-04
Validation rmse = 0.872227
Epoch 35
Loss = 3.8989e-01, PNorm = 53.6351, GNorm = 2.2057, lr_0 = 1.7783e-04
Loss = 4.3978e-01, PNorm = 53.6471, GNorm = 1.9132, lr_0 = 1.7139e-04
Validation rmse = 0.969226
Epoch 36
Loss = 4.1241e-01, PNorm = 53.6604, GNorm = 1.9217, lr_0 = 1.6518e-04
Validation rmse = 0.962031
Epoch 37
Loss = 3.5709e-01, PNorm = 53.6713, GNorm = 1.3090, lr_0 = 1.5919e-04
Validation rmse = 0.941551
Epoch 38
Loss = 5.0175e-01, PNorm = 53.6812, GNorm = 1.0600, lr_0 = 1.5286e-04
Loss = 4.0801e-01, PNorm = 53.6946, GNorm = 1.3287, lr_0 = 1.4732e-04
Validation rmse = 0.878264
Epoch 39
Loss = 3.9268e-01, PNorm = 53.7033, GNorm = 1.1499, lr_0 = 1.4199e-04
Validation rmse = 0.925135
Epoch 40
Loss = 3.2646e-01, PNorm = 53.7133, GNorm = 1.4663, lr_0 = 1.3684e-04
Loss = 4.1488e-01, PNorm = 53.7230, GNorm = 2.5481, lr_0 = 1.3188e-04
Validation rmse = 0.895092
Epoch 41
Loss = 4.2797e-01, PNorm = 53.7313, GNorm = 1.6490, lr_0 = 1.2711e-04
Validation rmse = 1.031333
Epoch 42
Loss = 4.5644e-01, PNorm = 53.7407, GNorm = 1.1134, lr_0 = 1.2250e-04
Validation rmse = 0.925841
Epoch 43
Loss = 3.5091e-01, PNorm = 53.7494, GNorm = 1.5416, lr_0 = 1.1806e-04
Loss = 4.0895e-01, PNorm = 53.7585, GNorm = 1.5198, lr_0 = 1.1379e-04
Validation rmse = 0.896148
Epoch 44
Loss = 3.8876e-01, PNorm = 53.7651, GNorm = 1.9204, lr_0 = 1.0966e-04
Validation rmse = 0.920750
Epoch 45
Loss = 3.2864e-01, PNorm = 53.7725, GNorm = 1.3074, lr_0 = 1.0569e-04
Loss = 4.0659e-01, PNorm = 53.7777, GNorm = 1.3153, lr_0 = 1.0186e-04
Validation rmse = 0.924273
Epoch 46
Loss = 3.7808e-01, PNorm = 53.7844, GNorm = 1.1127, lr_0 = 1.0000e-04
Validation rmse = 0.864869
Epoch 47
Loss = 3.9988e-01, PNorm = 53.7915, GNorm = 1.4322, lr_0 = 1.0000e-04
Validation rmse = 0.905681
Epoch 48
Loss = 2.4494e-01, PNorm = 53.7982, GNorm = 0.8619, lr_0 = 1.0000e-04
Loss = 4.2487e-01, PNorm = 53.8044, GNorm = 2.0546, lr_0 = 1.0000e-04
Validation rmse = 0.878348
Epoch 49
Loss = 3.2663e-01, PNorm = 53.8111, GNorm = 1.2651, lr_0 = 1.0000e-04
Validation rmse = 0.838388
Model 0 best validation rmse = 0.838388 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.838388
Ensemble test rmse = 0.838388
1-fold cross validation
	Seed 42 ==> test rmse = 0.838388
Overall test rmse = 0.838388 +/- 0.000000
Elapsed time = 0:07:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 592 | train size = 592 | val size = 218 | test size = 218
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0359e+00, PNorm = 52.0825, GNorm = 3.8460, lr_0 = 5.5000e-04
Validation rmse = 1.203792
Epoch 1
Loss = 1.0140e+00, PNorm = 52.1359, GNorm = 3.8817, lr_0 = 1.0000e-03
Validation rmse = 1.132305
Epoch 2
Loss = 9.5818e-01, PNorm = 52.2143, GNorm = 1.6184, lr_0 = 9.5733e-04
Validation rmse = 1.151198
Epoch 3
Loss = 1.0028e+00, PNorm = 52.2745, GNorm = 1.8480, lr_0 = 9.1648e-04
Validation rmse = 1.273262
Epoch 4
Loss = 7.0317e-01, PNorm = 52.3419, GNorm = 3.0851, lr_0 = 8.7737e-04
Validation rmse = 1.139176
Epoch 5
Loss = 7.5040e-01, PNorm = 52.3947, GNorm = 1.5258, lr_0 = 8.3993e-04
Loss = 7.6641e-01, PNorm = 52.4317, GNorm = 2.3907, lr_0 = 8.0409e-04
Validation rmse = 1.112312
Epoch 6
Loss = 7.5611e-01, PNorm = 52.4670, GNorm = 1.7953, lr_0 = 7.6977e-04
Validation rmse = 1.148021
Epoch 7
Loss = 7.1053e-01, PNorm = 52.5139, GNorm = 3.1175, lr_0 = 7.3372e-04
Validation rmse = 1.163588
Epoch 8
Loss = 6.9824e-01, PNorm = 52.5425, GNorm = 1.6533, lr_0 = 7.0241e-04
Validation rmse = 1.110118
Epoch 9
Loss = 7.4314e-01, PNorm = 52.5769, GNorm = 1.6152, lr_0 = 6.7244e-04
Validation rmse = 1.135364
Epoch 10
Loss = 6.6683e-01, PNorm = 52.6068, GNorm = 3.2676, lr_0 = 6.4374e-04
Loss = 6.7166e-01, PNorm = 52.6433, GNorm = 2.2337, lr_0 = 6.1627e-04
Validation rmse = 1.110430
Epoch 11
Loss = 6.2249e-01, PNorm = 52.6804, GNorm = 2.4325, lr_0 = 5.8997e-04
Validation rmse = 1.119740
Epoch 12
Loss = 7.4061e-01, PNorm = 52.7120, GNorm = 1.7771, lr_0 = 5.6480e-04
Validation rmse = 1.109616
Epoch 13
Loss = 6.6438e-01, PNorm = 52.7512, GNorm = 1.5287, lr_0 = 5.3834e-04
Validation rmse = 1.115186
Epoch 14
Loss = 6.4773e-01, PNorm = 52.7898, GNorm = 3.2837, lr_0 = 5.1537e-04
Validation rmse = 1.083633
Epoch 15
Loss = 7.0265e-01, PNorm = 52.8211, GNorm = 2.6267, lr_0 = 4.9338e-04
Validation rmse = 1.082769
Epoch 16
Loss = 7.0415e-01, PNorm = 52.8543, GNorm = 1.3385, lr_0 = 4.7233e-04
Loss = 5.8592e-01, PNorm = 52.8870, GNorm = 1.7369, lr_0 = 4.5217e-04
Validation rmse = 1.153841
Epoch 17
Loss = 5.9343e-01, PNorm = 52.9106, GNorm = 1.5862, lr_0 = 4.3288e-04
Validation rmse = 1.122651
Epoch 18
Loss = 5.8308e-01, PNorm = 52.9417, GNorm = 2.0165, lr_0 = 4.1440e-04
Validation rmse = 1.185308
Epoch 19
Loss = 5.4470e-01, PNorm = 52.9712, GNorm = 3.5615, lr_0 = 3.9499e-04
Validation rmse = 1.104155
Epoch 20
Loss = 5.8095e-01, PNorm = 53.0017, GNorm = 6.1430, lr_0 = 3.7814e-04
Validation rmse = 1.097551
Epoch 21
Loss = 5.7584e-01, PNorm = 53.0246, GNorm = 2.2732, lr_0 = 3.6200e-04
Loss = 6.1708e-01, PNorm = 53.0597, GNorm = 3.4811, lr_0 = 3.4656e-04
Validation rmse = 1.115871
Epoch 22
Loss = 5.4181e-01, PNorm = 53.0839, GNorm = 1.8322, lr_0 = 3.3177e-04
Validation rmse = 1.088394
Epoch 23
Loss = 5.7367e-01, PNorm = 53.1089, GNorm = 2.1062, lr_0 = 3.1761e-04
Validation rmse = 1.154190
Epoch 24
Loss = 4.7111e-01, PNorm = 53.1304, GNorm = 1.9986, lr_0 = 3.0406e-04
Validation rmse = 1.118922
Epoch 25
Loss = 4.5505e-01, PNorm = 53.1520, GNorm = 2.1946, lr_0 = 2.9108e-04
Validation rmse = 1.087981
Epoch 26
Loss = 4.6529e-01, PNorm = 53.1758, GNorm = 1.2129, lr_0 = 2.7745e-04
Validation rmse = 1.105312
Epoch 27
Loss = 6.5168e-01, PNorm = 53.1947, GNorm = 2.3280, lr_0 = 2.6561e-04
Loss = 5.0449e-01, PNorm = 53.2093, GNorm = 1.0764, lr_0 = 2.5427e-04
Validation rmse = 1.100133
Epoch 28
Loss = 5.4174e-01, PNorm = 53.2294, GNorm = 1.6647, lr_0 = 2.4342e-04
Validation rmse = 1.099564
Epoch 29
Loss = 4.8528e-01, PNorm = 53.2435, GNorm = 1.4286, lr_0 = 2.3304e-04
Validation rmse = 1.100786
Epoch 30
Loss = 5.1365e-01, PNorm = 53.2594, GNorm = 0.9175, lr_0 = 2.2309e-04
Validation rmse = 1.079541
Epoch 31
Loss = 3.8396e-01, PNorm = 53.2751, GNorm = 1.4169, lr_0 = 2.1357e-04
Validation rmse = 1.093210
Epoch 32
Loss = 4.6576e-01, PNorm = 53.2918, GNorm = 1.3628, lr_0 = 2.0357e-04
Loss = 4.7990e-01, PNorm = 53.3096, GNorm = 3.6815, lr_0 = 1.9488e-04
Validation rmse = 1.103008
Epoch 33
Loss = 4.6433e-01, PNorm = 53.3206, GNorm = 2.1426, lr_0 = 1.8657e-04
Validation rmse = 1.095278
Epoch 34
Loss = 5.0679e-01, PNorm = 53.3344, GNorm = 1.9748, lr_0 = 1.7861e-04
Validation rmse = 1.098757
Epoch 35
Loss = 4.2172e-01, PNorm = 53.3471, GNorm = 1.1151, lr_0 = 1.7098e-04
Validation rmse = 1.107412
Epoch 36
Loss = 4.9595e-01, PNorm = 53.3575, GNorm = 1.3248, lr_0 = 1.6369e-04
Validation rmse = 1.057077
Epoch 37
Loss = 5.8367e-01, PNorm = 53.3686, GNorm = 1.8529, lr_0 = 1.5670e-04
Validation rmse = 1.088556
Epoch 38
Loss = 2.8325e-01, PNorm = 53.3794, GNorm = 1.9346, lr_0 = 1.4936e-04
Loss = 4.9557e-01, PNorm = 53.3878, GNorm = 2.0851, lr_0 = 1.4299e-04
Validation rmse = 1.070550
Epoch 39
Loss = 4.6378e-01, PNorm = 53.3981, GNorm = 4.1561, lr_0 = 1.3689e-04
Validation rmse = 1.065348
Epoch 40
Loss = 4.8579e-01, PNorm = 53.4055, GNorm = 1.6554, lr_0 = 1.3105e-04
Validation rmse = 1.058337
Epoch 41
Loss = 3.7633e-01, PNorm = 53.4145, GNorm = 0.9233, lr_0 = 1.2545e-04
Validation rmse = 1.073777
Epoch 42
Loss = 3.7230e-01, PNorm = 53.4222, GNorm = 1.2683, lr_0 = 1.2010e-04
Validation rmse = 1.054385
Epoch 43
Loss = 4.0851e-01, PNorm = 53.4288, GNorm = 2.3079, lr_0 = 1.1498e-04
Loss = 4.4113e-01, PNorm = 53.4362, GNorm = 1.2691, lr_0 = 1.1007e-04
Loss = 5.1467e-01, PNorm = 53.4369, GNorm = 1.5325, lr_0 = 1.0959e-04
Validation rmse = 1.060117
Epoch 44
Loss = 4.4017e-01, PNorm = 53.4445, GNorm = 3.2649, lr_0 = 1.0491e-04
Validation rmse = 1.058384
Epoch 45
Loss = 4.0528e-01, PNorm = 53.4516, GNorm = 2.5234, lr_0 = 1.0044e-04
Validation rmse = 1.073641
Epoch 46
Loss = 4.2695e-01, PNorm = 53.4590, GNorm = 2.3454, lr_0 = 1.0000e-04
Validation rmse = 1.039068
Epoch 47
Loss = 4.1273e-01, PNorm = 53.4659, GNorm = 1.1705, lr_0 = 1.0000e-04
Validation rmse = 1.055154
Epoch 48
Loss = 3.6406e-01, PNorm = 53.4737, GNorm = 1.7216, lr_0 = 1.0000e-04
Loss = 4.3440e-01, PNorm = 53.4802, GNorm = 1.5053, lr_0 = 1.0000e-04
Validation rmse = 1.044913
Epoch 49
Loss = 4.0709e-01, PNorm = 53.4873, GNorm = 1.7457, lr_0 = 1.0000e-04
Validation rmse = 1.042473
Model 0 best validation rmse = 1.039068 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Model 0 test rmse = 1.039068
Ensemble test rmse = 1.039068
1-fold cross validation
	Seed 42 ==> test rmse = 1.039068
Overall test rmse = 1.039068 +/- 0.000000
Elapsed time = 0:04:08
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 613 | train size = 613 | val size = 197 | test size = 197
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0496e+00, PNorm = 52.0784, GNorm = 2.8463, lr_0 = 5.1250e-04
Validation rmse = 1.070617
Epoch 1
Loss = 1.0060e+00, PNorm = 52.1191, GNorm = 4.3138, lr_0 = 9.2500e-04
Validation rmse = 1.010525
Epoch 2
Loss = 9.2686e-01, PNorm = 52.2011, GNorm = 2.2128, lr_0 = 9.6466e-04
Validation rmse = 1.011332
Epoch 3
Loss = 6.9060e-01, PNorm = 52.2886, GNorm = 1.7852, lr_0 = 9.2316e-04
Validation rmse = 1.023653
Epoch 4
Loss = 1.1203e+00, PNorm = 52.3667, GNorm = 3.4175, lr_0 = 8.8699e-04
Loss = 7.4087e-01, PNorm = 52.4129, GNorm = 2.1444, lr_0 = 8.5223e-04
Validation rmse = 0.972843
Epoch 5
Loss = 7.5627e-01, PNorm = 52.4715, GNorm = 1.2242, lr_0 = 8.1556e-04
Validation rmse = 0.949505
Epoch 6
Loss = 6.7242e-01, PNorm = 52.5074, GNorm = 2.0068, lr_0 = 7.8048e-04
Validation rmse = 0.957903
Epoch 7
Loss = 7.3661e-01, PNorm = 52.5427, GNorm = 2.6223, lr_0 = 7.4690e-04
Validation rmse = 1.039424
Epoch 8
Loss = 7.9105e-01, PNorm = 52.5830, GNorm = 3.6962, lr_0 = 7.1763e-04
Loss = 6.7616e-01, PNorm = 52.6169, GNorm = 1.8286, lr_0 = 6.8951e-04
Loss = 5.0176e-01, PNorm = 52.6218, GNorm = 2.5960, lr_0 = 6.8676e-04
Validation rmse = 0.959619
Epoch 9
Loss = 7.1218e-01, PNorm = 52.6477, GNorm = 2.4756, lr_0 = 6.5985e-04
Validation rmse = 0.969237
Epoch 10
Loss = 6.7937e-01, PNorm = 52.6881, GNorm = 1.9658, lr_0 = 6.3146e-04
Validation rmse = 0.938072
Epoch 11
Loss = 5.6813e-01, PNorm = 52.7201, GNorm = 0.9060, lr_0 = 6.0430e-04
Validation rmse = 0.952310
Epoch 12
Loss = 6.8205e-01, PNorm = 52.7371, GNorm = 1.7547, lr_0 = 5.8062e-04
Validation rmse = 0.953333
Epoch 13
Loss = 4.6581e-01, PNorm = 52.7732, GNorm = 1.5128, lr_0 = 5.5564e-04
Loss = 6.1097e-01, PNorm = 52.8033, GNorm = 1.1742, lr_0 = 5.3386e-04
Validation rmse = 0.952633
Epoch 14
Loss = 6.2299e-01, PNorm = 52.8442, GNorm = 2.0610, lr_0 = 5.1090e-04
Validation rmse = 0.955442
Epoch 15
Loss = 6.2547e-01, PNorm = 52.8657, GNorm = 2.0124, lr_0 = 4.8892e-04
Validation rmse = 0.949032
Epoch 16
Loss = 5.6619e-01, PNorm = 52.8901, GNorm = 1.2536, lr_0 = 4.6976e-04
Validation rmse = 0.936982
Epoch 17
Loss = 8.1793e-01, PNorm = 52.9214, GNorm = 1.0456, lr_0 = 4.4955e-04
Loss = 5.3716e-01, PNorm = 52.9510, GNorm = 2.9871, lr_0 = 4.3193e-04
Loss = 7.0749e-01, PNorm = 52.9521, GNorm = 4.6365, lr_0 = 4.3021e-04
Validation rmse = 0.911658
Epoch 18
Loss = 5.9027e-01, PNorm = 52.9830, GNorm = 1.0666, lr_0 = 4.1335e-04
Validation rmse = 0.906403
Epoch 19
Loss = 6.1122e-01, PNorm = 53.0064, GNorm = 2.6690, lr_0 = 3.9557e-04
Validation rmse = 0.904041
Epoch 20
Loss = 5.6494e-01, PNorm = 53.0344, GNorm = 1.4637, lr_0 = 3.8007e-04
Validation rmse = 0.889506
Epoch 21
Loss = 3.7953e-01, PNorm = 53.0654, GNorm = 0.9825, lr_0 = 3.6372e-04
Validation rmse = 0.874563
Epoch 22
Loss = 3.4299e-01, PNorm = 53.0936, GNorm = 1.0544, lr_0 = 3.4807e-04
Loss = 5.2141e-01, PNorm = 53.1155, GNorm = 0.9400, lr_0 = 3.3443e-04
Validation rmse = 0.854038
Epoch 23
Loss = 5.4388e-01, PNorm = 53.1364, GNorm = 1.7954, lr_0 = 3.2004e-04
Validation rmse = 0.887227
Epoch 24
Loss = 6.7499e-01, PNorm = 53.1598, GNorm = 1.5057, lr_0 = 3.0750e-04
Validation rmse = 0.889139
Epoch 25
Loss = 4.9569e-01, PNorm = 53.1788, GNorm = 1.2917, lr_0 = 2.9427e-04
Validation rmse = 0.876775
Epoch 26
Loss = 3.0863e-01, PNorm = 53.2025, GNorm = 0.9213, lr_0 = 2.8161e-04
Loss = 5.3302e-01, PNorm = 53.2187, GNorm = 2.2662, lr_0 = 2.7058e-04
Validation rmse = 0.847880
Epoch 27
Loss = 4.9299e-01, PNorm = 53.2307, GNorm = 2.1627, lr_0 = 2.5997e-04
Validation rmse = 0.854476
Epoch 28
Loss = 4.6448e-01, PNorm = 53.2461, GNorm = 2.1041, lr_0 = 2.4879e-04
Validation rmse = 0.871647
Epoch 29
Loss = 4.6030e-01, PNorm = 53.2628, GNorm = 1.6670, lr_0 = 2.3809e-04
Validation rmse = 0.828990
Epoch 30
Loss = 6.1481e-01, PNorm = 53.2817, GNorm = 0.9542, lr_0 = 2.2784e-04
Loss = 4.8355e-01, PNorm = 53.2982, GNorm = 4.1770, lr_0 = 2.1892e-04
Validation rmse = 0.826767
Epoch 31
Loss = 4.7496e-01, PNorm = 53.3090, GNorm = 0.9878, lr_0 = 2.1034e-04
Validation rmse = 0.889927
Epoch 32
Loss = 4.5259e-01, PNorm = 53.3256, GNorm = 0.8398, lr_0 = 2.0129e-04
Validation rmse = 0.840505
Epoch 33
Loss = 4.0287e-01, PNorm = 53.3385, GNorm = 1.0552, lr_0 = 1.9263e-04
Validation rmse = 0.859066
Epoch 34
Loss = 5.4600e-01, PNorm = 53.3501, GNorm = 1.6416, lr_0 = 1.8434e-04
Validation rmse = 0.820319
Epoch 35
Loss = 4.0364e-01, PNorm = 53.3610, GNorm = 1.1000, lr_0 = 1.7712e-04
Loss = 4.4490e-01, PNorm = 53.3734, GNorm = 1.4929, lr_0 = 1.7018e-04
Validation rmse = 0.856353
Epoch 36
Loss = 4.5850e-01, PNorm = 53.3850, GNorm = 1.3172, lr_0 = 1.6286e-04
Validation rmse = 0.811873
Epoch 37
Loss = 4.5099e-01, PNorm = 53.3923, GNorm = 2.1411, lr_0 = 1.5585e-04
Validation rmse = 0.818525
Epoch 38
Loss = 3.5223e-01, PNorm = 53.4037, GNorm = 1.5718, lr_0 = 1.4915e-04
Validation rmse = 0.843322
Epoch 39
Loss = 6.3694e-01, PNorm = 53.4108, GNorm = 1.3135, lr_0 = 1.4330e-04
Loss = 4.1679e-01, PNorm = 53.4220, GNorm = 1.4833, lr_0 = 1.3769e-04
Loss = 2.0445e-01, PNorm = 53.4226, GNorm = 1.8542, lr_0 = 1.3714e-04
Validation rmse = 0.811610
Epoch 40
Loss = 4.3544e-01, PNorm = 53.4294, GNorm = 1.1170, lr_0 = 1.3176e-04
Validation rmse = 0.821644
Epoch 41
Loss = 4.6792e-01, PNorm = 53.4376, GNorm = 1.5797, lr_0 = 1.2609e-04
Validation rmse = 0.820079
Epoch 42
Loss = 4.7135e-01, PNorm = 53.4457, GNorm = 1.9555, lr_0 = 1.2067e-04
Validation rmse = 0.855655
Epoch 43
Loss = 5.3029e-01, PNorm = 53.4529, GNorm = 1.2148, lr_0 = 1.1594e-04
Validation rmse = 0.823060
Epoch 44
Loss = 2.0504e-01, PNorm = 53.4583, GNorm = 0.7732, lr_0 = 1.1095e-04
Loss = 4.9954e-01, PNorm = 53.4636, GNorm = 2.1394, lr_0 = 1.0661e-04
Validation rmse = 0.811597
Epoch 45
Loss = 4.6296e-01, PNorm = 53.4702, GNorm = 1.1625, lr_0 = 1.0202e-04
Validation rmse = 0.833889
Epoch 46
Loss = 5.1378e-01, PNorm = 53.4754, GNorm = 1.1548, lr_0 = 1.0000e-04
Validation rmse = 0.816904
Epoch 47
Loss = 2.7322e-01, PNorm = 53.4791, GNorm = 0.9261, lr_0 = 1.0000e-04
Validation rmse = 0.812554
Epoch 48
Loss = 5.3901e-01, PNorm = 53.4842, GNorm = 1.4428, lr_0 = 1.0000e-04
Loss = 4.1592e-01, PNorm = 53.4890, GNorm = 1.2811, lr_0 = 1.0000e-04
Loss = 3.4949e-01, PNorm = 53.4891, GNorm = 1.9361, lr_0 = 1.0000e-04
Validation rmse = 0.825537
Epoch 49
Loss = 4.1203e-01, PNorm = 53.4941, GNorm = 1.3618, lr_0 = 1.0000e-04
Validation rmse = 0.807946
Model 0 best validation rmse = 0.807946 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Model 0 test rmse = 0.807946
Ensemble test rmse = 0.807946
1-fold cross validation
	Seed 42 ==> test rmse = 0.807946
Overall test rmse = 0.807946 +/- 0.000000
Elapsed time = 0:05:35
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 678 | train size = 678 | val size = 132 | test size = 132
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0385e+00, PNorm = 52.0802, GNorm = 2.0063, lr_0 = 4.8077e-04
Validation rmse = 0.843157
Epoch 1
Loss = 1.1433e+00, PNorm = 52.1155, GNorm = 2.3244, lr_0 = 8.6154e-04
Validation rmse = 0.832694
Epoch 2
Loss = 8.6461e-01, PNorm = 52.1937, GNorm = 1.9498, lr_0 = 9.7810e-04
Loss = 8.8872e-01, PNorm = 52.2660, GNorm = 2.5539, lr_0 = 9.4267e-04
Loss = 1.4104e+00, PNorm = 52.2718, GNorm = 5.1498, lr_0 = 9.3920e-04
Validation rmse = 0.821529
Epoch 3
Loss = 8.0851e-01, PNorm = 52.3386, GNorm = 2.3936, lr_0 = 9.0517e-04
Validation rmse = 0.800097
Epoch 4
Loss = 7.7832e-01, PNorm = 52.3771, GNorm = 1.0628, lr_0 = 8.7238e-04
Validation rmse = 0.833979
Epoch 5
Loss = 8.0886e-01, PNorm = 52.4249, GNorm = 0.8248, lr_0 = 8.3768e-04
Loss = 7.6546e-01, PNorm = 52.4687, GNorm = 0.7126, lr_0 = 8.0733e-04
Validation rmse = 0.831119
Epoch 6
Loss = 7.4193e-01, PNorm = 52.5045, GNorm = 0.8889, lr_0 = 7.7808e-04
Validation rmse = 0.787526
Epoch 7
Loss = 7.7721e-01, PNorm = 52.5309, GNorm = 2.9373, lr_0 = 7.4713e-04
Validation rmse = 0.792201
Epoch 8
Loss = 7.7214e-01, PNorm = 52.5647, GNorm = 1.1809, lr_0 = 7.2007e-04
Loss = 6.8473e-01, PNorm = 52.5973, GNorm = 1.1972, lr_0 = 6.9398e-04
Validation rmse = 0.873337
Epoch 9
Loss = 7.3369e-01, PNorm = 52.6402, GNorm = 1.4269, lr_0 = 6.6884e-04
Validation rmse = 0.797960
Epoch 10
Loss = 8.2958e-01, PNorm = 52.6897, GNorm = 2.3037, lr_0 = 6.4223e-04
Validation rmse = 0.761482
Epoch 11
Loss = 6.8251e-01, PNorm = 52.7295, GNorm = 2.6250, lr_0 = 6.1897e-04
Loss = 6.1598e-01, PNorm = 52.7725, GNorm = 1.2266, lr_0 = 5.9654e-04
Validation rmse = 0.760406
Epoch 12
Loss = 6.4853e-01, PNorm = 52.8168, GNorm = 1.2331, lr_0 = 5.7281e-04
Validation rmse = 0.790812
Epoch 13
Loss = 6.7091e-01, PNorm = 52.8626, GNorm = 1.9927, lr_0 = 5.5206e-04
Validation rmse = 0.794434
Epoch 14
Loss = 5.2962e-01, PNorm = 52.9054, GNorm = 1.0218, lr_0 = 5.3010e-04
Loss = 6.2112e-01, PNorm = 52.9394, GNorm = 2.2018, lr_0 = 5.1090e-04
Validation rmse = 0.813705
Epoch 15
Loss = 6.0318e-01, PNorm = 52.9740, GNorm = 2.2265, lr_0 = 4.9239e-04
Validation rmse = 0.751724
Epoch 16
Loss = 4.9653e-01, PNorm = 53.0104, GNorm = 1.3257, lr_0 = 4.7280e-04
Loss = 5.7137e-01, PNorm = 53.0380, GNorm = 2.0387, lr_0 = 4.5567e-04
Validation rmse = 0.798951
Epoch 17
Loss = 5.7378e-01, PNorm = 53.0702, GNorm = 2.6741, lr_0 = 4.3917e-04
Validation rmse = 0.764289
Epoch 18
Loss = 5.9064e-01, PNorm = 53.0994, GNorm = 3.2513, lr_0 = 4.2326e-04
Validation rmse = 0.775339
Epoch 19
Loss = 5.1845e-01, PNorm = 53.1310, GNorm = 1.3445, lr_0 = 4.0642e-04
Loss = 5.1826e-01, PNorm = 53.1611, GNorm = 1.0360, lr_0 = 3.9170e-04
Validation rmse = 0.782761
Epoch 20
Loss = 4.5287e-01, PNorm = 53.1862, GNorm = 1.1755, lr_0 = 3.7751e-04
Validation rmse = 0.769013
Epoch 21
Loss = 5.0482e-01, PNorm = 53.2188, GNorm = 2.3152, lr_0 = 3.6249e-04
Validation rmse = 0.798869
Epoch 22
Loss = 5.3141e-01, PNorm = 53.2421, GNorm = 1.1231, lr_0 = 3.4936e-04
Loss = 4.9849e-01, PNorm = 53.2809, GNorm = 1.9503, lr_0 = 3.3670e-04
Validation rmse = 0.779206
Epoch 23
Loss = 4.7368e-01, PNorm = 53.3087, GNorm = 1.3362, lr_0 = 3.2331e-04
Validation rmse = 0.782865
Epoch 24
Loss = 4.0347e-01, PNorm = 53.3253, GNorm = 2.0061, lr_0 = 3.1159e-04
Validation rmse = 0.796399
Epoch 25
Loss = 4.9448e-01, PNorm = 53.3499, GNorm = 1.0637, lr_0 = 3.0031e-04
Loss = 4.9453e-01, PNorm = 53.3760, GNorm = 1.6486, lr_0 = 2.8943e-04
Validation rmse = 0.785807
Epoch 26
Loss = 4.4060e-01, PNorm = 53.3982, GNorm = 1.0791, lr_0 = 2.7791e-04
Validation rmse = 0.776428
Epoch 27
Loss = 4.9461e-01, PNorm = 53.4186, GNorm = 2.2322, lr_0 = 2.6785e-04
Validation rmse = 0.799999
Epoch 28
Loss = 4.0300e-01, PNorm = 53.4398, GNorm = 1.4399, lr_0 = 2.5719e-04
Loss = 4.4936e-01, PNorm = 53.4561, GNorm = 1.1004, lr_0 = 2.4787e-04
Validation rmse = 0.798140
Epoch 29
Loss = 4.2370e-01, PNorm = 53.4721, GNorm = 0.9711, lr_0 = 2.3889e-04
Validation rmse = 0.783524
Epoch 30
Loss = 5.0279e-01, PNorm = 53.4913, GNorm = 2.9733, lr_0 = 2.2939e-04
Loss = 4.2945e-01, PNorm = 53.5081, GNorm = 2.0461, lr_0 = 2.2108e-04
Validation rmse = 0.809394
Epoch 31
Loss = 4.0660e-01, PNorm = 53.5231, GNorm = 2.2657, lr_0 = 2.1307e-04
Validation rmse = 0.786724
Epoch 32
Loss = 4.7865e-01, PNorm = 53.5412, GNorm = 2.3860, lr_0 = 2.0460e-04
Validation rmse = 0.787879
Epoch 33
Loss = 4.5542e-01, PNorm = 53.5541, GNorm = 1.4141, lr_0 = 1.9718e-04
Loss = 3.8427e-01, PNorm = 53.5663, GNorm = 1.1617, lr_0 = 1.9004e-04
Validation rmse = 0.811164
Epoch 34
Loss = 3.8583e-01, PNorm = 53.5774, GNorm = 2.6501, lr_0 = 1.8316e-04
Validation rmse = 0.774169
Epoch 35
Loss = 4.2512e-01, PNorm = 53.5947, GNorm = 1.0324, lr_0 = 1.7587e-04
Validation rmse = 0.828342
Epoch 36
Loss = 3.4284e-01, PNorm = 53.6066, GNorm = 1.0662, lr_0 = 1.6950e-04
Loss = 4.1956e-01, PNorm = 53.6161, GNorm = 1.7281, lr_0 = 1.6336e-04
Validation rmse = 0.804223
Epoch 37
Loss = 4.4306e-01, PNorm = 53.6272, GNorm = 1.6226, lr_0 = 1.5686e-04
Validation rmse = 0.797488
Epoch 38
Loss = 4.4427e-01, PNorm = 53.6381, GNorm = 1.4940, lr_0 = 1.5118e-04
Validation rmse = 0.796153
Epoch 39
Loss = 4.2424e-01, PNorm = 53.6467, GNorm = 1.0462, lr_0 = 1.4516e-04
Loss = 4.4144e-01, PNorm = 53.6565, GNorm = 2.4486, lr_0 = 1.3991e-04
Validation rmse = 0.806865
Epoch 40
Loss = 4.1303e-01, PNorm = 53.6651, GNorm = 0.9703, lr_0 = 1.3484e-04
Validation rmse = 0.803640
Epoch 41
Loss = 4.3106e-01, PNorm = 53.6749, GNorm = 1.3737, lr_0 = 1.2947e-04
Validation rmse = 0.820639
Epoch 42
Loss = 2.4061e-01, PNorm = 53.6840, GNorm = 1.1050, lr_0 = 1.2478e-04
Loss = 3.7913e-01, PNorm = 53.6895, GNorm = 1.5763, lr_0 = 1.2026e-04
Validation rmse = 0.809751
Epoch 43
Loss = 3.8272e-01, PNorm = 53.6959, GNorm = 1.6866, lr_0 = 1.1591e-04
Validation rmse = 0.803550
Epoch 44
Loss = 4.5487e-01, PNorm = 53.7035, GNorm = 3.3011, lr_0 = 1.1129e-04
Loss = 3.7143e-01, PNorm = 53.7112, GNorm = 3.4186, lr_0 = 1.0726e-04
Validation rmse = 0.808032
Epoch 45
Loss = 4.0687e-01, PNorm = 53.7169, GNorm = 1.6669, lr_0 = 1.0338e-04
Validation rmse = 0.787011
Epoch 46
Loss = 3.6205e-01, PNorm = 53.7218, GNorm = 0.9442, lr_0 = 1.0000e-04
Validation rmse = 0.800585
Epoch 47
Loss = 3.5544e-01, PNorm = 53.7281, GNorm = 1.1744, lr_0 = 1.0000e-04
Loss = 3.8693e-01, PNorm = 53.7355, GNorm = 1.1262, lr_0 = 1.0000e-04
Loss = 2.1136e-01, PNorm = 53.7361, GNorm = 1.3132, lr_0 = 1.0000e-04
Validation rmse = 0.783366
Epoch 48
Loss = 3.4701e-01, PNorm = 53.7409, GNorm = 1.1347, lr_0 = 1.0000e-04
Validation rmse = 0.809262
Epoch 49
Loss = 4.1980e-01, PNorm = 53.7471, GNorm = 1.6404, lr_0 = 1.0000e-04
Validation rmse = 0.812318
Model 0 best validation rmse = 0.751724 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Model 0 test rmse = 0.751724
Ensemble test rmse = 0.751724
1-fold cross validation
	Seed 42 ==> test rmse = 0.751724
Overall test rmse = 0.751724 +/- 0.000000
Elapsed time = 0:05:24
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 703 | train size = 703 | val size = 107 | test size = 107
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0146e+00, PNorm = 52.0799, GNorm = 2.4551, lr_0 = 4.5357e-04
Validation rmse = 0.992345
Epoch 1
Loss = 1.1442e+00, PNorm = 52.1108, GNorm = 2.2138, lr_0 = 8.0714e-04
Validation rmse = 0.902488
Epoch 2
Loss = 8.8114e-01, PNorm = 52.1934, GNorm = 2.5289, lr_0 = 9.8301e-04
Loss = 9.4814e-01, PNorm = 52.2682, GNorm = 1.0041, lr_0 = 9.4990e-04
Validation rmse = 0.876047
Epoch 3
Loss = 8.7392e-01, PNorm = 52.3277, GNorm = 1.7193, lr_0 = 9.1476e-04
Validation rmse = 0.847411
Epoch 4
Loss = 8.6728e-01, PNorm = 52.3853, GNorm = 2.0656, lr_0 = 8.8093e-04
Loss = 7.8418e-01, PNorm = 52.4314, GNorm = 1.3560, lr_0 = 8.5125e-04
Loss = 9.7022e-01, PNorm = 52.4326, GNorm = 11.0922, lr_0 = 8.4834e-04
Validation rmse = 0.840674
Epoch 5
Loss = 8.0418e-01, PNorm = 52.4696, GNorm = 2.5990, lr_0 = 8.1977e-04
Validation rmse = 0.801583
Epoch 6
Loss = 7.6058e-01, PNorm = 52.5026, GNorm = 1.6008, lr_0 = 7.8944e-04
Validation rmse = 0.785641
Epoch 7
Loss = 6.0531e-01, PNorm = 52.5342, GNorm = 1.0265, lr_0 = 7.6024e-04
Loss = 6.8526e-01, PNorm = 52.5600, GNorm = 0.9771, lr_0 = 7.3463e-04
Validation rmse = 0.784587
Epoch 8
Loss = 7.0454e-01, PNorm = 52.5805, GNorm = 1.9252, lr_0 = 7.0746e-04
Validation rmse = 0.801213
Epoch 9
Loss = 5.5505e-01, PNorm = 52.6138, GNorm = 0.9829, lr_0 = 6.8129e-04
Loss = 7.4950e-01, PNorm = 52.6419, GNorm = 0.9053, lr_0 = 6.5834e-04
Loss = 4.6858e-01, PNorm = 52.6470, GNorm = 7.3371, lr_0 = 6.5609e-04
Validation rmse = 0.768302
Epoch 10
Loss = 7.7349e-01, PNorm = 52.6791, GNorm = 1.0944, lr_0 = 6.3399e-04
Validation rmse = 0.757769
Epoch 11
Loss = 6.7791e-01, PNorm = 52.7270, GNorm = 1.3788, lr_0 = 6.1054e-04
Validation rmse = 0.835420
Epoch 12
Loss = 4.7607e-01, PNorm = 52.7655, GNorm = 2.2878, lr_0 = 5.8796e-04
Loss = 6.9305e-01, PNorm = 52.7978, GNorm = 0.7582, lr_0 = 5.6815e-04
Validation rmse = 0.771884
Epoch 13
Loss = 5.9137e-01, PNorm = 52.8328, GNorm = 2.5358, lr_0 = 5.4714e-04
Validation rmse = 0.845167
Epoch 14
Loss = 5.9396e-01, PNorm = 52.8653, GNorm = 2.0990, lr_0 = 5.2690e-04
Loss = 6.6571e-01, PNorm = 52.8974, GNorm = 3.0314, lr_0 = 5.0915e-04
Loss = 2.9181e-01, PNorm = 52.9012, GNorm = 3.2964, lr_0 = 5.0741e-04
Validation rmse = 0.757163
Epoch 15
Loss = 6.0336e-01, PNorm = 52.9337, GNorm = 1.1725, lr_0 = 4.9032e-04
Validation rmse = 0.765903
Epoch 16
Loss = 6.7048e-01, PNorm = 52.9751, GNorm = 1.3552, lr_0 = 4.7218e-04
Validation rmse = 0.765857
Epoch 17
Loss = 5.6736e-01, PNorm = 53.0108, GNorm = 2.1819, lr_0 = 4.5627e-04
Loss = 5.7281e-01, PNorm = 53.0436, GNorm = 1.4302, lr_0 = 4.4091e-04
Validation rmse = 0.747745
Epoch 18
Loss = 6.2737e-01, PNorm = 53.0749, GNorm = 1.6592, lr_0 = 4.2460e-04
Validation rmse = 0.770568
Epoch 19
Loss = 5.2787e-01, PNorm = 53.1129, GNorm = 2.4991, lr_0 = 4.0889e-04
Loss = 5.9960e-01, PNorm = 53.1407, GNorm = 1.8682, lr_0 = 3.9512e-04
Validation rmse = 0.766536
Epoch 20
Loss = 6.3515e-01, PNorm = 53.1694, GNorm = 1.6229, lr_0 = 3.8050e-04
Validation rmse = 0.744527
Epoch 21
Loss = 5.6502e-01, PNorm = 53.1940, GNorm = 1.7010, lr_0 = 3.6643e-04
Validation rmse = 0.751748
Epoch 22
Loss = 5.9124e-01, PNorm = 53.2210, GNorm = 1.2412, lr_0 = 3.5287e-04
Loss = 5.2447e-01, PNorm = 53.2448, GNorm = 1.4070, lr_0 = 3.4099e-04
Validation rmse = 0.751577
Epoch 23
Loss = 5.3664e-01, PNorm = 53.2694, GNorm = 1.3792, lr_0 = 3.2837e-04
Validation rmse = 0.772864
Epoch 24
Loss = 5.5278e-01, PNorm = 53.2890, GNorm = 1.7170, lr_0 = 3.1623e-04
Loss = 5.0470e-01, PNorm = 53.3116, GNorm = 1.3402, lr_0 = 3.0558e-04
Validation rmse = 0.769701
Epoch 25
Loss = 5.4916e-01, PNorm = 53.3338, GNorm = 0.9570, lr_0 = 2.9427e-04
Validation rmse = 0.776570
Epoch 26
Loss = 4.9446e-01, PNorm = 53.3556, GNorm = 1.4390, lr_0 = 2.8339e-04
Validation rmse = 0.751222
Epoch 27
Loss = 4.8497e-01, PNorm = 53.3745, GNorm = 1.6078, lr_0 = 2.7291e-04
Loss = 5.1974e-01, PNorm = 53.3942, GNorm = 1.4442, lr_0 = 2.6371e-04
Validation rmse = 0.728016
Epoch 28
Loss = 4.3753e-01, PNorm = 53.4128, GNorm = 1.5918, lr_0 = 2.5396e-04
Validation rmse = 0.745826
Epoch 29
Loss = 5.5598e-01, PNorm = 53.4285, GNorm = 1.4765, lr_0 = 2.4456e-04
Loss = 4.4621e-01, PNorm = 53.4430, GNorm = 3.1458, lr_0 = 2.3633e-04
Validation rmse = 0.734268
Epoch 30
Loss = 5.0381e-01, PNorm = 53.4543, GNorm = 1.4728, lr_0 = 2.2758e-04
Validation rmse = 0.762115
Epoch 31
Loss = 5.2767e-01, PNorm = 53.4667, GNorm = 1.8254, lr_0 = 2.1917e-04
Validation rmse = 0.766199
Epoch 32
Loss = 5.7578e-01, PNorm = 53.4821, GNorm = 0.9855, lr_0 = 2.1106e-04
Loss = 5.0612e-01, PNorm = 53.4972, GNorm = 1.9011, lr_0 = 2.0395e-04
Validation rmse = 0.727593
Epoch 33
Loss = 5.0122e-01, PNorm = 53.5083, GNorm = 1.1156, lr_0 = 1.9641e-04
Validation rmse = 0.739637
Epoch 34
Loss = 3.4832e-01, PNorm = 53.5180, GNorm = 1.1523, lr_0 = 1.8979e-04
Loss = 4.7124e-01, PNorm = 53.5274, GNorm = 1.6433, lr_0 = 1.8340e-04
Validation rmse = 0.765904
Epoch 35
Loss = 4.6804e-01, PNorm = 53.5432, GNorm = 1.0361, lr_0 = 1.7661e-04
Validation rmse = 0.725296
Epoch 36
Loss = 5.6923e-01, PNorm = 53.5541, GNorm = 1.3435, lr_0 = 1.7008e-04
Loss = 4.6116e-01, PNorm = 53.5635, GNorm = 0.7704, lr_0 = 1.6435e-04
Loss = 2.1379e-01, PNorm = 53.5642, GNorm = 4.1938, lr_0 = 1.6379e-04
Validation rmse = 0.750597
Epoch 37
Loss = 5.1766e-01, PNorm = 53.5741, GNorm = 1.3521, lr_0 = 1.5827e-04
Validation rmse = 0.736691
Epoch 38
Loss = 4.3524e-01, PNorm = 53.5858, GNorm = 2.3523, lr_0 = 1.5242e-04
Validation rmse = 0.724587
Epoch 39
Loss = 6.1544e-01, PNorm = 53.5966, GNorm = 1.5874, lr_0 = 1.4678e-04
Loss = 4.6968e-01, PNorm = 53.6010, GNorm = 1.8226, lr_0 = 1.4184e-04
Validation rmse = 0.741167
Epoch 40
Loss = 5.0028e-01, PNorm = 53.6111, GNorm = 1.1943, lr_0 = 1.3659e-04
Validation rmse = 0.724180
Epoch 41
Loss = 5.5372e-01, PNorm = 53.6183, GNorm = 2.2748, lr_0 = 1.3154e-04
Loss = 4.3295e-01, PNorm = 53.6273, GNorm = 1.2988, lr_0 = 1.2711e-04
Loss = 1.9766e-01, PNorm = 53.6280, GNorm = 1.3067, lr_0 = 1.2667e-04
Validation rmse = 0.722657
Epoch 42
Loss = 5.0122e-01, PNorm = 53.6337, GNorm = 1.2722, lr_0 = 1.2240e-04
Validation rmse = 0.735127
Epoch 43
Loss = 4.6909e-01, PNorm = 53.6414, GNorm = 1.8247, lr_0 = 1.1788e-04
Validation rmse = 0.721380
Epoch 44
Loss = 4.4929e-01, PNorm = 53.6480, GNorm = 1.8211, lr_0 = 1.1352e-04
Loss = 4.3827e-01, PNorm = 53.6550, GNorm = 1.4155, lr_0 = 1.0969e-04
Validation rmse = 0.714241
Epoch 45
Loss = 5.0629e-01, PNorm = 53.6633, GNorm = 1.4521, lr_0 = 1.0564e-04
Validation rmse = 0.751733
Epoch 46
Loss = 3.9591e-01, PNorm = 53.6693, GNorm = 0.9560, lr_0 = 1.0173e-04
Loss = 4.6122e-01, PNorm = 53.6748, GNorm = 1.3669, lr_0 = 1.0000e-04
Loss = 1.6764e+00, PNorm = 53.6754, GNorm = 14.0260, lr_0 = 1.0000e-04
Validation rmse = 0.713138
Epoch 47
Loss = 4.6280e-01, PNorm = 53.6793, GNorm = 0.7712, lr_0 = 1.0000e-04
Validation rmse = 0.736817
Epoch 48
Loss = 4.4946e-01, PNorm = 53.6840, GNorm = 1.1895, lr_0 = 1.0000e-04
Validation rmse = 0.718355
Epoch 49
Loss = 4.0152e-01, PNorm = 53.6897, GNorm = 1.7448, lr_0 = 1.0000e-04
Loss = 4.6629e-01, PNorm = 53.6941, GNorm = 2.0096, lr_0 = 1.0000e-04
Validation rmse = 0.733300
Model 0 best validation rmse = 0.713138 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Model 0 test rmse = 0.713138
Ensemble test rmse = 0.713138
1-fold cross validation
	Seed 42 ==> test rmse = 0.713138
Overall test rmse = 0.713138 +/- 0.000000
Elapsed time = 0:05:15
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 654 | train size = 654 | val size = 156 | test size = 156
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0567e+00, PNorm = 52.0757, GNorm = 2.8378, lr_0 = 4.8077e-04
Validation rmse = 1.021325
Epoch 1
Loss = 1.0333e+00, PNorm = 52.1125, GNorm = 1.2670, lr_0 = 8.6154e-04
Validation rmse = 1.108142
Epoch 2
Loss = 8.7272e-01, PNorm = 52.1914, GNorm = 1.6328, lr_0 = 9.7450e-04
Validation rmse = 1.015966
Epoch 3
Loss = 1.1274e+00, PNorm = 52.2710, GNorm = 2.1314, lr_0 = 9.3574e-04
Loss = 7.7935e-01, PNorm = 52.3264, GNorm = 2.9510, lr_0 = 9.0184e-04
Validation rmse = 1.184384
Epoch 4
Loss = 8.8653e-01, PNorm = 52.3806, GNorm = 3.7902, lr_0 = 8.6596e-04
Validation rmse = 0.951235
Epoch 5
Loss = 6.9963e-01, PNorm = 52.4301, GNorm = 3.1638, lr_0 = 8.3152e-04
Validation rmse = 1.058728
Epoch 6
Loss = 5.6789e-01, PNorm = 52.4700, GNorm = 0.9965, lr_0 = 7.9844e-04
Loss = 6.6438e-01, PNorm = 52.4970, GNorm = 1.3001, lr_0 = 7.6952e-04
Validation rmse = 1.016350
Epoch 7
Loss = 7.3818e-01, PNorm = 52.5289, GNorm = 2.5009, lr_0 = 7.3891e-04
Validation rmse = 1.098409
Epoch 8
Loss = 7.3839e-01, PNorm = 52.5713, GNorm = 1.4823, lr_0 = 7.0951e-04
Validation rmse = 0.972278
Epoch 9
Loss = 7.7959e-01, PNorm = 52.6097, GNorm = 2.2110, lr_0 = 6.8129e-04
Loss = 6.9577e-01, PNorm = 52.6445, GNorm = 1.1155, lr_0 = 6.5661e-04
Loss = 5.4907e-01, PNorm = 52.6470, GNorm = 4.9354, lr_0 = 6.5419e-04
Validation rmse = 0.969139
Epoch 10
Loss = 7.3916e-01, PNorm = 52.6813, GNorm = 4.4597, lr_0 = 6.3049e-04
Validation rmse = 1.111426
Epoch 11
Loss = 7.1231e-01, PNorm = 52.7214, GNorm = 2.9785, lr_0 = 6.0541e-04
Validation rmse = 1.025711
Epoch 12
Loss = 6.6135e-01, PNorm = 52.7585, GNorm = 1.1265, lr_0 = 5.8133e-04
Loss = 6.4028e-01, PNorm = 52.7903, GNorm = 2.2125, lr_0 = 5.6027e-04
Validation rmse = 1.023867
Epoch 13
Loss = 6.7107e-01, PNorm = 52.8317, GNorm = 3.0973, lr_0 = 5.3997e-04
Validation rmse = 1.003211
Epoch 14
Loss = 6.0995e-01, PNorm = 52.8641, GNorm = 1.0762, lr_0 = 5.1849e-04
Validation rmse = 0.919431
Epoch 15
Loss = 5.7573e-01, PNorm = 52.8943, GNorm = 1.3113, lr_0 = 4.9787e-04
Validation rmse = 0.955531
Epoch 16
Loss = 1.1176e+00, PNorm = 52.9285, GNorm = 2.5570, lr_0 = 4.7807e-04
Loss = 5.6899e-01, PNorm = 52.9618, GNorm = 1.5507, lr_0 = 4.6075e-04
Validation rmse = 0.902592
Epoch 17
Loss = 5.7703e-01, PNorm = 52.9943, GNorm = 1.0175, lr_0 = 4.4242e-04
Validation rmse = 0.905996
Epoch 18
Loss = 8.1031e-01, PNorm = 53.0315, GNorm = 2.2782, lr_0 = 4.2482e-04
Validation rmse = 0.951476
Epoch 19
Loss = 5.2062e-01, PNorm = 53.0500, GNorm = 1.3423, lr_0 = 4.0792e-04
Loss = 6.0785e-01, PNorm = 53.0790, GNorm = 0.6839, lr_0 = 3.9314e-04
Validation rmse = 0.933382
Epoch 20
Loss = 5.8840e-01, PNorm = 53.1047, GNorm = 1.7415, lr_0 = 3.7751e-04
Validation rmse = 0.893477
Epoch 21
Loss = 5.6238e-01, PNorm = 53.1245, GNorm = 1.6069, lr_0 = 3.6249e-04
Validation rmse = 0.879281
Epoch 22
Loss = 5.5719e-01, PNorm = 53.1519, GNorm = 0.9321, lr_0 = 3.4807e-04
Loss = 5.6170e-01, PNorm = 53.1747, GNorm = 2.0515, lr_0 = 3.3546e-04
Loss = 1.7337e-01, PNorm = 53.1762, GNorm = 2.3875, lr_0 = 3.3422e-04
Validation rmse = 0.998211
Epoch 23
Loss = 6.0836e-01, PNorm = 53.2015, GNorm = 2.1723, lr_0 = 3.2212e-04
Validation rmse = 0.933652
Epoch 24
Loss = 5.8205e-01, PNorm = 53.2328, GNorm = 1.8994, lr_0 = 3.0930e-04
Validation rmse = 0.876645
Epoch 25
Loss = 5.1089e-01, PNorm = 53.2563, GNorm = 1.2825, lr_0 = 2.9810e-04
Loss = 5.5517e-01, PNorm = 53.2844, GNorm = 3.0952, lr_0 = 2.8730e-04
Loss = 3.9085e-01, PNorm = 53.2857, GNorm = 4.2016, lr_0 = 2.8624e-04
Validation rmse = 0.869716
Epoch 26
Loss = 5.2900e-01, PNorm = 53.3031, GNorm = 1.5592, lr_0 = 2.7587e-04
Validation rmse = 0.867658
Epoch 27
Loss = 4.2711e-01, PNorm = 53.3201, GNorm = 1.6518, lr_0 = 2.6490e-04
Validation rmse = 0.951632
Epoch 28
Loss = 5.4297e-01, PNorm = 53.3327, GNorm = 1.4003, lr_0 = 2.5436e-04
Validation rmse = 0.936894
Epoch 29
Loss = 3.4074e-01, PNorm = 53.3463, GNorm = 0.9574, lr_0 = 2.4424e-04
Loss = 5.3579e-01, PNorm = 53.3599, GNorm = 1.0817, lr_0 = 2.3539e-04
Validation rmse = 0.894913
Epoch 30
Loss = 4.4439e-01, PNorm = 53.3772, GNorm = 1.1300, lr_0 = 2.2603e-04
Validation rmse = 0.892956
Epoch 31
Loss = 3.7763e-01, PNorm = 53.3923, GNorm = 1.3297, lr_0 = 2.1704e-04
Validation rmse = 0.944621
Epoch 32
Loss = 4.6253e-01, PNorm = 53.4047, GNorm = 2.1708, lr_0 = 2.0841e-04
Loss = 4.9703e-01, PNorm = 53.4173, GNorm = 1.3648, lr_0 = 2.0086e-04
Validation rmse = 0.931894
Epoch 33
Loss = 4.9807e-01, PNorm = 53.4328, GNorm = 0.8956, lr_0 = 1.9287e-04
Validation rmse = 0.860296
Epoch 34
Loss = 4.5580e-01, PNorm = 53.4465, GNorm = 1.0881, lr_0 = 1.8519e-04
Validation rmse = 0.886880
Epoch 35
Loss = 7.0140e-01, PNorm = 53.4599, GNorm = 1.4606, lr_0 = 1.7783e-04
Loss = 4.0211e-01, PNorm = 53.4685, GNorm = 1.0901, lr_0 = 1.7139e-04
Loss = 6.3633e-02, PNorm = 53.4694, GNorm = 0.9338, lr_0 = 1.7075e-04
Validation rmse = 0.887659
Epoch 36
Loss = 4.7265e-01, PNorm = 53.4775, GNorm = 0.8326, lr_0 = 1.6457e-04
Validation rmse = 0.898807
Epoch 37
Loss = 4.2759e-01, PNorm = 53.4870, GNorm = 1.0845, lr_0 = 1.5802e-04
Validation rmse = 0.950765
Epoch 38
Loss = 3.8450e-01, PNorm = 53.4961, GNorm = 1.1288, lr_0 = 1.5230e-04
Loss = 4.9613e-01, PNorm = 53.5045, GNorm = 3.1148, lr_0 = 1.4678e-04
Loss = 9.5558e-01, PNorm = 53.5052, GNorm = 5.6318, lr_0 = 1.4624e-04
Validation rmse = 0.961170
Epoch 39
Loss = 4.3558e-01, PNorm = 53.5142, GNorm = 2.0547, lr_0 = 1.4094e-04
Validation rmse = 0.884841
Epoch 40
Loss = 5.2831e-01, PNorm = 53.5220, GNorm = 1.2534, lr_0 = 1.3534e-04
Validation rmse = 0.887994
Epoch 41
Loss = 4.0060e-01, PNorm = 53.5306, GNorm = 2.2037, lr_0 = 1.2995e-04
Validation rmse = 0.955353
Epoch 42
Loss = 6.4512e-01, PNorm = 53.5368, GNorm = 1.4370, lr_0 = 1.2478e-04
Loss = 4.7912e-01, PNorm = 53.5454, GNorm = 1.6942, lr_0 = 1.2026e-04
Validation rmse = 0.911091
Epoch 43
Loss = 5.0409e-01, PNorm = 53.5536, GNorm = 2.0306, lr_0 = 1.1548e-04
Validation rmse = 0.940803
Epoch 44
Loss = 4.1774e-01, PNorm = 53.5605, GNorm = 1.8117, lr_0 = 1.1088e-04
Validation rmse = 0.872836
Epoch 45
Loss = 6.5942e-01, PNorm = 53.5689, GNorm = 1.5067, lr_0 = 1.0647e-04
Loss = 4.3076e-01, PNorm = 53.5753, GNorm = 2.7098, lr_0 = 1.0262e-04
Validation rmse = 0.914560
Epoch 46
Loss = 4.2524e-01, PNorm = 53.5814, GNorm = 1.2620, lr_0 = 1.0000e-04
Validation rmse = 0.933643
Epoch 47
Loss = 3.9357e-01, PNorm = 53.5866, GNorm = 1.5393, lr_0 = 1.0000e-04
Validation rmse = 0.888409
Epoch 48
Loss = 3.5330e-01, PNorm = 53.5923, GNorm = 1.3025, lr_0 = 1.0000e-04
Loss = 4.6464e-01, PNorm = 53.5983, GNorm = 0.9349, lr_0 = 1.0000e-04
Loss = 7.8067e-02, PNorm = 53.5990, GNorm = 2.4153, lr_0 = 1.0000e-04
Validation rmse = 0.878098
Epoch 49
Loss = 4.2455e-01, PNorm = 53.6044, GNorm = 1.5889, lr_0 = 1.0000e-04
Validation rmse = 0.921641
Model 0 best validation rmse = 0.860296 on epoch 33
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Model 0 test rmse = 0.860296
Ensemble test rmse = 0.860296
1-fold cross validation
	Seed 42 ==> test rmse = 0.860296
Overall test rmse = 0.860296 +/- 0.000000
Elapsed time = 0:05:25
